{"version":3,"file":"js/app.2cbff0d2.js","mappings":"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","sources":["webpack://gowebsocket-frontend/./src/App.vue?bba9","webpack://gowebsocket-frontend/src/App.vue","webpack://gowebsocket-frontend/./src/App.vue?6a4a","webpack://gowebsocket-frontend/./src/App.vue","webpack://gowebsocket-frontend/./src/utils/storage.js","webpack://gowebsocket-frontend/./src/services/api.js","webpack://gowebsocket-frontend/./src/store/modules/auth.js","webpack://gowebsocket-frontend/./src/store/modules/user.js","webpack://gowebsocket-frontend/./src/store/modules/friend.js","webpack://gowebsocket-frontend/./src/store/modules/chat.js","webpack://gowebsocket-frontend/./src/utils/constants.js","webpack://gowebsocket-frontend/./src/utils/helpers.js","webpack://gowebsocket-frontend/./src/services/websocket.js","webpack://gowebsocket-frontend/./src/store/modules/connection.js","webpack://gowebsocket-frontend/./src/store/index.js","webpack://gowebsocket-frontend/./src/views/LoginPage.vue?d71d","webpack://gowebsocket-frontend/src/views/LoginPage.vue","webpack://gowebsocket-frontend/./src/views/LoginPage.vue?559d","webpack://gowebsocket-frontend/./src/views/LoginPage.vue","webpack://gowebsocket-frontend/./src/views/ChatRoom.vue?aa1f","webpack://gowebsocket-frontend/./src/components/friend/FriendList.vue?86aa","webpack://gowebsocket-frontend/src/components/friend/FriendList.vue","webpack://gowebsocket-frontend/./src/components/friend/FriendList.vue?1ead","webpack://gowebsocket-frontend/./src/components/friend/FriendList.vue","webpack://gowebsocket-frontend/./src/components/chat/ChatWindow.vue?f0a6","webpack://gowebsocket-frontend/src/components/chat/ChatWindow.vue","webpack://gowebsocket-frontend/./src/components/chat/ChatWindow.vue?8278","webpack://gowebsocket-frontend/./src/components/chat/ChatWindow.vue","webpack://gowebsocket-frontend/src/views/ChatRoom.vue","webpack://gowebsocket-frontend/./src/views/ChatRoom.vue?9843","webpack://gowebsocket-frontend/./src/views/ChatRoom.vue","webpack://gowebsocket-frontend/./src/router/index.js","webpack://gowebsocket-frontend/./src/main.js","webpack://gowebsocket-frontend/webpack/bootstrap","webpack://gowebsocket-frontend/webpack/runtime/amd options","webpack://gowebsocket-frontend/webpack/runtime/chunk loaded","webpack://gowebsocket-frontend/webpack/runtime/compat get default export","webpack://gowebsocket-frontend/webpack/runtime/define property getters","webpack://gowebsocket-frontend/webpack/runtime/global","webpack://gowebsocket-frontend/webpack/runtime/hasOwnProperty shorthand","webpack://gowebsocket-frontend/webpack/runtime/make namespace object","webpack://gowebsocket-frontend/webpack/runtime/node module decorator","webpack://gowebsocket-frontend/webpack/runtime/jsonp chunk loading","webpack://gowebsocket-frontend/webpack/startup"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"app\">\n    <router-view/>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'App'\n}\n</script>\n\n<style lang=\"scss\">\n#app {\n  font-family: 'Microsoft YaHei', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  color: #2c3e50;\n  height: 100vh;\n  overflow: hidden;\n}\n</style>","import mod from \"-!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=52e23952\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\nimport style0 from \"./App.vue?vue&type=style&index=0&id=52e23952&prod&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// 本地存储工具\n\nconst TOKEN_KEY = 'gowebsocket_token'\nconst USER_INFO_KEY = 'gowebsocket_userInfo'\n\n// Token相关\nexport const setToken = (token) => {\n  localStorage.setItem(TOKEN_KEY, token)\n}\n\nexport const getToken = () => {\n  return localStorage.getItem(TOKEN_KEY)\n}\n\nexport const removeToken = () => {\n  localStorage.removeItem(TOKEN_KEY)\n}\n\n// 用户信息相关\nexport const setUserInfo = (userInfo) => {\n  localStorage.setItem(USER_INFO_KEY, JSON.stringify(userInfo))\n}\n\nexport const getUserInfo = () => {\n  const userInfo = localStorage.getItem(USER_INFO_KEY)\n  return userInfo ? JSON.parse(userInfo) : null\n}\n\nexport const removeUserInfo = () => {\n  localStorage.removeItem(USER_INFO_KEY)\n}\n\n// 清除所有存储\nexport const clearAll = () => {\n  removeToken()\n  removeUserInfo()\n}","import axios from 'axios'\nimport { getToken } from '@/utils/storage'\n\n// 创建axios实例\nconst api = axios.create({\n  baseURL: process.env.NODE_ENV === 'production' ? '' : '/api',\n  timeout: 10000\n})\n\n// 请求拦截器\napi.interceptors.request.use(\n  config => {\n    const token = getToken()\n    if (token) {\n      config.headers.Authorization = token\n    }\n    return config\n  },\n  error => {\n    return Promise.reject(error)\n  }\n)\n\n// 响应拦截器\napi.interceptors.response.use(\n  response => {\n    return response\n  },\n  error => {\n    if (error.response?.status === 401) {\n      // token失效，清除本地存储并跳转到登录页\n      localStorage.removeItem('token')\n      localStorage.removeItem('userInfo')\n      window.location.href = '/login'\n    }\n    return Promise.reject(error)\n  }\n)\n\n// 认证API\nexport const authAPI = {\n  login: (data) => api.post('/auth/login', data),\n  logout: () => api.post('/auth/logout'),\n  getCurrentUser: () => api.get('/auth/me')\n}\n\n// 好友API\nexport const friendAPI = {\n  getFriendList: () => api.get('/friend/list'),\n  addFriend: (friendID) => api.post('/friend/add', { friendID }),\n  deleteFriend: (friendID) => api.delete(`/friend/${friendID}`)\n}\n\n// 消息API\nexport const messageAPI = {\n  getChatHistory: (params) => api.get('/message/history', { params }),\n  sendMessage: (data) => api.post('/message/send', data),\n  markAsRead: (data) => api.put('/message/read', data),\n  getUnreadCount: () => api.get('/message/unread')\n}\n\n// 用户API (兼容原有接口)\nexport const userAPI = {\n  getList: (params) => api.get('/user/list', { params }),\n  getOnlineStatus: (params) => api.get('/user/online', { params }),\n  sendMessage: (data) => api.post('/user/sendMessage', data),\n  sendMessageAll: (data) => api.post('/user/sendMessageAll', data)\n}\n\nexport default api","import { authAPI } from '@/services/api'\nimport { setToken, removeToken } from '@/utils/storage'\n\nconst auth = {\n  namespaced: true,\n  state: {\n    token: localStorage.getItem('token') || null,\n    isAuthenticated: !!localStorage.getItem('token'),\n    loginLoading: false,\n    userInfo: JSON.parse(localStorage.getItem('userInfo') || 'null')\n  },\n  mutations: {\n    SET_TOKEN(state, token) {\n      state.token = token\n      state.isAuthenticated = !!token\n      if (token) {\n        setToken(token)\n      } else {\n        removeToken()\n      }\n    },\n    SET_LOGIN_LOADING(state, loading) {\n      state.loginLoading = loading\n    },\n    SET_USER_INFO(state, userInfo) {\n      state.userInfo = userInfo\n      if (userInfo) {\n        localStorage.setItem('userInfo', JSON.stringify(userInfo))\n      } else {\n        localStorage.removeItem('userInfo')\n      }\n    },\n    CLEAR_AUTH(state) {\n      state.token = null\n      state.isAuthenticated = false\n      state.userInfo = null\n      removeToken()\n      localStorage.removeItem('userInfo')\n    }\n  },\n  actions: {\n    async login({ commit }, { userID, appID = 'app_default_001' }) {\n      commit('SET_LOGIN_LOADING', true)\n      try {\n        const response = await authAPI.login({ userID, appID })\n        if (response.data.code === 200) {\n          const { token, user } = response.data.data\n          commit('SET_TOKEN', token)\n          commit('SET_USER_INFO', user)\n          return { success: true, user, isNewUser: user.isNewUser }\n        } else {\n          return { success: false, error: response.data.message }\n        }\n      } catch (error) {\n        console.error('登录失败:', error)\n        return { success: false, error: error.message || '登录失败' }\n      } finally {\n        commit('SET_LOGIN_LOADING', false)\n      }\n    },\n    async logout({ commit }) {\n      try {\n        await authAPI.logout()\n      } catch (error) {\n        console.error('登出失败:', error)\n      } finally {\n        commit('CLEAR_AUTH')\n        // 清理其他模块状态\n        commit('user/CLEAR_USER_INFO', null, { root: true })\n        commit('friend/CLEAR_FRIENDS', null, { root: true })\n        commit('chat/CLEAR_CONVERSATIONS', null, { root: true })\n        commit('connection/SET_CONNECTION_STATUS', 'disconnected', { root: true })\n      }\n    },\n    async getCurrentUser({ commit, state }) {\n      if (!state.token) {\n        return { success: false, error: '未登录' }\n      }\n      try {\n        const response = await authAPI.getCurrentUser()\n        if (response.data.code === 200) {\n          commit('SET_USER_INFO', response.data.data.user)\n          return { success: true, user: response.data.data.user }\n        } else {\n          return { success: false, error: response.data.message }\n        }\n      } catch (error) {\n        console.error('获取用户信息失败:', error)\n        return { success: false, error: error.message || '获取用户信息失败' }\n      }\n    }\n  },\n  getters: {\n    isLoggedIn: state => state.isAuthenticated && state.token,\n    currentUser: state => state.userInfo\n  }\n}\n\nexport default auth","const user = {\n  namespaced: true,\n  state: {\n    userInfo: null,\n    appID: 101,\n    profile: null\n  },\n  mutations: {\n    SET_USER_INFO(state, userInfo) {\n      state.userInfo = userInfo\n    },\n    SET_APP_ID(state, appID) {\n      state.appID = appID\n    },\n    SET_PROFILE(state, profile) {\n      state.profile = profile\n    },\n    CLEAR_USER_INFO(state) {\n      state.userInfo = null\n      state.profile = null\n    }\n  },\n  actions: {\n    async fetchProfile({ commit }, userID) {\n      try {\n        // 这里可以添加获取用户详细资料的API调用\n        // const response = await userAPI.getProfile(userID)\n        // commit('SET_PROFILE', response.data)\n        // return response.data\n        console.log('获取用户资料:', userID)\n      } catch (error) {\n        console.error('获取用户资料失败:', error)\n      }\n    }\n  },\n  getters: {\n    currentUserID: state => state.userInfo?.userID,\n    currentNickname: state => state.userInfo?.nickname,\n    currentAvatar: state => state.userInfo?.avatar\n  }\n}\n\nexport default user","import { friendAPI } from '@/services/api'\n\nconst friend = {\n  namespaced: true,\n  state: {\n    friendList: [],\n    onlineUsers: [],\n    selectedFriend: null,\n    loadingFriends: false\n  },\n  mutations: {\n    SET_FRIEND_LIST(state, friends) {\n      state.friendList = friends\n    },\n    SET_ONLINE_USERS(state, users) {\n      state.onlineUsers = users\n    },\n    SET_SELECTED_FRIEND(state, friend) {\n      state.selectedFriend = friend\n    },\n    SET_LOADING_FRIENDS(state, loading) {\n      state.loadingFriends = loading\n    },\n    ADD_FRIEND(state, friend) {\n      if (!state.friendList.find(f => f.userID === friend.userID)) {\n        state.friendList.push(friend)\n      }\n    },\n    REMOVE_FRIEND(state, userID) {\n      state.friendList = state.friendList.filter(f => f.userID !== userID)\n    },\n    UPDATE_FRIEND_STATUS(state, { userID, isOnline }) {\n      const friend = state.friendList.find(f => f.userID === userID)\n      if (friend) {\n        friend.isOnline = isOnline\n      }\n    },\n    UPDATE_FRIEND_UNREAD(state, { userID, unreadCount }) {\n      const friend = state.friendList.find(f => f.userID === userID)\n      if (friend) {\n        friend.unreadCount = unreadCount\n      }\n    },\n    CLEAR_FRIENDS(state) {\n      state.friendList = []\n      state.onlineUsers = []\n      state.selectedFriend = null\n    }\n  },\n  actions: {\n    async fetchFriendList({ commit }) {\n      commit('SET_LOADING_FRIENDS', true)\n      try {\n        const response = await friendAPI.getFriendList()\n        if (response.data.code === 200) {\n          commit('SET_FRIEND_LIST', response.data.data.friends)\n          return { success: true, friends: response.data.data.friends }\n        } else {\n          return { success: false, error: response.data.message }\n        }\n      } catch (error) {\n        console.error('获取好友列表失败:', error)\n        return { success: false, error: error.message || '获取好友列表失败' }\n      } finally {\n        commit('SET_LOADING_FRIENDS', false)\n      }\n    },\n    async addFriend({ commit }, friendID) {\n      try {\n        const response = await friendAPI.addFriend(friendID)\n        if (response.data.code === 200) {\n          commit('ADD_FRIEND', response.data.data.friend)\n          return { success: true, friend: response.data.data.friend }\n        } else {\n          return { success: false, error: response.data.message }\n        }\n      } catch (error) {\n        console.error('添加好友失败:', error)\n        return { success: false, error: error.message || '添加好友失败' }\n      }\n    },\n    async deleteFriend({ commit }, friendID) {\n      try {\n        const response = await friendAPI.deleteFriend(friendID)\n        if (response.data.code === 200) {\n          commit('REMOVE_FRIEND', friendID)\n          return { success: true }\n        } else {\n          return { success: false, error: response.data.message }\n        }\n      } catch (error) {\n        console.error('删除好友失败:', error)\n        return { success: false, error: error.message || '删除好友失败' }\n      }\n    },\n    selectFriend({ commit }, friend) {\n      commit('SET_SELECTED_FRIEND', friend)\n    },\n    updateFriendOnlineStatus({ commit }, { userID, isOnline }) {\n      commit('UPDATE_FRIEND_STATUS', { userID, isOnline })\n    },\n    updateFriendUnreadCount({ commit }, { userID, unreadCount }) {\n      commit('UPDATE_FRIEND_UNREAD', { userID, unreadCount })\n    }\n  },\n  getters: {\n    onlineFriends: state => state.friendList.filter(f => f.isOnline),\n    offlineFriends: state => state.friendList.filter(f => !f.isOnline),\n    totalUnreadCount: state => state.friendList.reduce((total, friend) => total + (friend.unreadCount || 0), 0),\n    getFriendByID: state => userID => state.friendList.find(f => f.userID === userID)\n  }\n}\n\nexport default friend","import { messageAPI } from '@/services/api'\n\nconst chat = {\n  namespaced: true,\n  state: {\n    conversations: {}, // 按friendID组织的对话记录\n    currentConversation: null,\n    loadingHistory: false,\n    sendingMessage: false\n  },\n  mutations: {\n    SET_CONVERSATION(state, { friendID, messages }) {\n      state.conversations[friendID] = messages\n    },\n    ADD_MESSAGE(state, { friendID, message }) {\n      if (!state.conversations[friendID]) {\n        state.conversations[friendID] = []\n      }\n      // 检查消息是否已存在（避免重复）\n      const exists = state.conversations[friendID].find(m => m.messageID === message.messageID)\n      if (!exists) {\n        state.conversations[friendID].push(message)\n      }\n    },\n    PREPEND_MESSAGES(state, { friendID, messages }) {\n      if (!state.conversations[friendID]) {\n        state.conversations[friendID] = []\n      }\n      // 将历史消息添加到对话开头\n      state.conversations[friendID] = [...messages, ...state.conversations[friendID]]\n    },\n    SET_CURRENT_CONVERSATION(state, friendID) {\n      state.currentConversation = friendID\n    },\n    SET_LOADING_HISTORY(state, loading) {\n      state.loadingHistory = loading\n    },\n    SET_SENDING_MESSAGE(state, sending) {\n      state.sendingMessage = sending\n    },\n    CLEAR_CONVERSATIONS(state) {\n      state.conversations = {}\n      state.currentConversation = null\n    },\n    CLEAR_CONVERSATION(state, friendID) {\n      if (state.conversations[friendID]) {\n        delete state.conversations[friendID]\n      }\n    }\n  },\n  actions: {\n    async loadChatHistory({ commit, state }, { friendID, page = 1, limit = 20 }) {\n      commit('SET_LOADING_HISTORY', true)\n      try {\n        const response = await messageAPI.getChatHistory({ friendID, page, limit })\n        if (response.data.code === 200) {\n          const { messages, hasMore } = response.data.data\n          if (page === 1) {\n            // 第一页，直接设置对话\n            commit('SET_CONVERSATION', { friendID, messages })\n          } else {\n            // 后续页，添加到对话开头\n            commit('PREPEND_MESSAGES', { friendID, messages })\n          }\n          return { success: true, messages, hasMore }\n        } else {\n          return { success: false, error: response.data.message }\n        }\n      } catch (error) {\n        console.error('加载聊天记录失败:', error)\n        return { success: false, error: error.message || '加载聊天记录失败' }\n      } finally {\n        commit('SET_LOADING_HISTORY', false)\n      }\n    },\n    async sendMessage({ commit, dispatch }, { friendID, content, messageType = 'text' }) {\n      commit('SET_SENDING_MESSAGE', true)\n      try {\n        const response = await messageAPI.sendMessage({ friendID, content, messageType })\n        if (response.data.code === 200) {\n          const message = response.data.data.message\n          commit('ADD_MESSAGE', { friendID, message })\n          // 更新好友未读计数（对方的）\n          dispatch('friend/updateFriendUnreadCount', { userID: friendID, unreadCount: 0 }, { root: true })\n          return { success: true, message }\n        } else {\n          return { success: false, error: response.data.message }\n        }\n      } catch (error) {\n        console.error('发送消息失败:', error)\n        return { success: false, error: error.message || '发送消息失败' }\n      } finally {\n        commit('SET_SENDING_MESSAGE', false)\n      }\n    },\n    async markAsRead({ commit }, friendID) {\n      try {\n        const response = await messageAPI.markAsRead({ friendID })\n        if (response.data.code === 200) {\n          // 清除本地未读计数\n          commit('friend/UPDATE_FRIEND_UNREAD', { userID: friendID, unreadCount: 0 }, { root: true })\n          return { success: true }\n        } else {\n          return { success: false, error: response.data.message }\n        }\n      } catch (error) {\n        console.error('标记已读失败:', error)\n        return { success: false, error: error.message || '标记已读失败' }\n      }\n    },\n    // 通过WebSocket接收到新消息时调用\n    receiveMessage({ commit }, { fromUserID, message }) {\n      commit('ADD_MESSAGE', { friendID: fromUserID, message })\n      // 更新未读计数\n      commit('friend/UPDATE_FRIEND_UNREAD', { \n        userID: fromUserID, \n        unreadCount: (this.getters['friend/getFriendByID'](fromUserID)?.unreadCount || 0) + 1 \n      }, { root: true })\n    },\n    switchConversation({ commit, dispatch }, friendID) {\n      commit('SET_CURRENT_CONVERSATION', friendID)\n      // 标记消息为已读\n      dispatch('markAsRead', friendID)\n    }\n  },\n  getters: {\n    getCurrentMessages: state => {\n      if (!state.currentConversation) return []\n      return state.conversations[state.currentConversation] || []\n    },\n    getMessagesByFriend: state => friendID => {\n      return state.conversations[friendID] || []\n    },\n    hasMessages: state => friendID => {\n      return !!(state.conversations[friendID] && state.conversations[friendID].length > 0)\n    }\n  }\n}\n\nexport default chat","// 应用常量定义\n\n// WebSocket相关\nexport const WS_URL = process.env.NODE_ENV === 'production' \n  ? 'ws://127.0.0.1:8089/acc' \n  : 'ws://127.0.0.1:8089/acc'\n\n// 应用配置\nexport const APP_CONFIG = {\n  APP_ID: 'app_default_001',\n  DEFAULT_AVATAR: '/images/default-avatar.png',\n  MESSAGE_PAGE_SIZE: 20,\n  HEARTBEAT_INTERVAL: 30000, // 30秒\n  RECONNECT_MAX_ATTEMPTS: 5,\n  RECONNECT_DELAY: 1000 // 1秒\n}\n\n// 消息类型\nexport const MESSAGE_TYPES = {\n  TEXT: 'text',\n  IMAGE: 'image',\n  FILE: 'file',\n  SYSTEM: 'system'\n}\n\n// WebSocket命令类型\nexport const WS_COMMANDS = {\n  LOGIN: 'login',\n  LOGOUT: 'logout',\n  HEARTBEAT: 'heartbeat',\n  MESSAGE: 'msg',\n  ENTER: 'enter',\n  EXIT: 'exit',\n  PING: 'ping'\n}\n\n// 连接状态\nexport const CONNECTION_STATUS = {\n  DISCONNECTED: 'disconnected',\n  CONNECTING: 'connecting',\n  CONNECTED: 'connected',\n  RECONNECTING: 'reconnecting'\n}\n\n// 响应状态码\nexport const API_CODES = {\n  SUCCESS: 200,\n  NOT_LOGGED_IN: 1000,\n  PARAMETER_ILLEGAL: 1001,\n  UNAUTHORIZED_USER_ID: 1002,\n  UNAUTHORIZED: 1003,\n  SERVER_ERROR: 1004\n}","// 辅助工具函数\n\n/**\n * 生成唯一ID\n */\nexport const generateId = () => {\n  return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`\n}\n\n/**\n * 格式化时间\n */\nexport const formatTime = (time) => {\n  if (!time) return ''\n  \n  const date = new Date(time)\n  const now = new Date()\n  const diff = now - date\n  \n  // 1分钟内\n  if (diff < 60000) {\n    return '刚刚'\n  }\n  \n  // 1小时内\n  if (diff < 3600000) {\n    return `${Math.floor(diff / 60000)}分钟前`\n  }\n  \n  // 今天\n  if (date.toDateString() === now.toDateString()) {\n    return date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })\n  }\n  \n  // 昨天\n  const yesterday = new Date(now)\n  yesterday.setDate(yesterday.getDate() - 1)\n  if (date.toDateString() === yesterday.toDateString()) {\n    return `昨天 ${date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })}`\n  }\n  \n  // 更早\n  return date.toLocaleDateString('zh-CN') + ' ' + date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })\n}\n\n/**\n * 格式化消息时间（简化版）\n */\nexport const formatMessageTime = (time) => {\n  if (!time) return ''\n  \n  const date = new Date(time)\n  const now = new Date()\n  \n  // 今天\n  if (date.toDateString() === now.toDateString()) {\n    return date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })\n  }\n  \n  // 其他日期\n  return date.toLocaleDateString('zh-CN', { month: '2-digit', day: '2-digit' }) + ' ' + \n         date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })\n}\n\n/**\n * 防抖函数\n */\nexport const debounce = (func, wait) => {\n  let timeout\n  return function executedFunction(...args) {\n    const later = () => {\n      clearTimeout(timeout)\n      func(...args)\n    }\n    clearTimeout(timeout)\n    timeout = setTimeout(later, wait)\n  }\n}\n\n/**\n * 节流函数\n */\nexport const throttle = (func, limit) => {\n  let inThrottle\n  return function() {\n    const args = arguments\n    const context = this\n    if (!inThrottle) {\n      func.apply(context, args)\n      inThrottle = true\n      setTimeout(() => inThrottle = false, limit)\n    }\n  }\n}\n\n/**\n * 滚动到底部\n */\nexport const scrollToBottom = (element, smooth = true) => {\n  if (!element) return\n  \n  element.scrollTo({\n    top: element.scrollHeight,\n    behavior: smooth ? 'smooth' : 'auto'\n  })\n}\n\n/**\n * 检查是否滚动到底部\n */\nexport const isScrolledToBottom = (element, threshold = 10) => {\n  if (!element) return false\n  \n  return element.scrollHeight - element.scrollTop - element.clientHeight < threshold\n}\n\n/**\n * 复制文本到剪贴板\n */\nexport const copyToClipboard = async (text) => {\n  try {\n    await navigator.clipboard.writeText(text)\n    return true\n  } catch (err) {\n    // 降级方案\n    const textArea = document.createElement('textarea')\n    textArea.value = text\n    document.body.appendChild(textArea)\n    textArea.focus()\n    textArea.select()\n    try {\n      document.execCommand('copy')\n      return true\n    } catch (err) {\n      return false\n    } finally {\n      document.body.removeChild(textArea)\n    }\n  }\n}\n\n/**\n * 文件大小格式化\n */\nexport const formatFileSize = (bytes) => {\n  if (bytes === 0) return '0 Bytes'\n  \n  const k = 1024\n  const sizes = ['Bytes', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  \n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n}\n\n/**\n * 随机生成用户ID（用于演示）\n */\nexport const generateUserId = () => {\n  return Math.floor(Math.random() * 90000) + 10000\n}\n\n/**\n * 生成设备AppID（字符串格式）\n */\nexport const generateAppId = () => {\n  const timestamp = Date.now().toString(36)\n  const random = Math.random().toString(36).substr(2, 8)\n  return `app_${timestamp}_${random}`\n}","import store from '@/store'\nimport { WS_URL, WS_COMMANDS, CONNECTION_STATUS } from '@/utils/constants'\nimport { generateId } from '@/utils/helpers'\n\nclass WebSocketService {\n  constructor() {\n    this.ws = null\n    this.heartbeatTimer = null\n    this.reconnectTimer = null\n    this.maxReconnectAttempts = 5\n    this.reconnectAttempts = 0\n    this.reconnectDelay = 1000\n    this.heartbeatInterval = 30000 // 30秒\n    this.isConnecting = false\n    this.isDestroyed = false\n    this.url = ''\n    this.userID = '' // 从登录响应中获取\n    \n    // 消息队列，用于连接恢复后重发\n    this.messageQueue = []\n    \n    // 绑定this上下文\n    this.onOpen = this.onOpen.bind(this)\n    this.onMessage = this.onMessage.bind(this)\n    this.onClose = this.onClose.bind(this)\n    this.onError = this.onError.bind(this)\n  }\n\n  /**\n   * 连接WebSocket\n   * @param {string} url - WebSocket服务器地址\n   * @param {string} token - 用户认证token\n   */\n  connect(url, token) {\n    return new Promise((resolve, reject) => {\n      if (this.isDestroyed) {\n        reject(new Error('WebSocket服务已销毁'))\n        return\n      }\n\n      if (this.isConnecting) {\n        reject(new Error('正在连接中'))\n        return\n      }\n\n      if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n        resolve(this.ws)\n        return\n      }\n\n      // 验证必要参数\n      if (!token) {\n        reject(new Error('token不能为空'))\n        return\n      }\n\n      this.url = url\n      this.token = token // 保存token以便在onOpen时使用\n      this.isConnecting = true\n\n      try {\n        console.log(`开始连接WebSocket: ${url}`)\n        console.log(`连接信息: hasToken=${!!token}`)\n        store.commit('connection/SET_CONNECTION_STATUS', CONNECTION_STATUS.CONNECTING)\n\n        this.ws = new WebSocket(url)\n        this.ws.onopen = () => {\n          this.onOpen()\n          resolve(this.ws)\n        }\n        this.ws.onmessage = this.onMessage\n        this.ws.onclose = this.onClose\n        this.ws.onerror = (error) => {\n          this.onError(error)\n          reject(error)\n        }\n\n        // 连接超时处理\n        setTimeout(() => {\n          if (this.isConnecting) {\n            this.isConnecting = false\n            reject(new Error('连接超时'))\n          }\n        }, 10000)\n\n      } catch (error) {\n        this.isConnecting = false\n        store.commit('connection/SET_CONNECTION_STATUS', CONNECTION_STATUS.DISCONNECTED)\n        reject(error)\n      }\n    })\n  }\n\n  /**\n   * 断开连接\n   */\n  disconnect() {\n    this.isDestroyed = true\n    this.stopHeartbeat()\n    this.stopReconnect()\n    \n    if (this.ws) {\n      this.ws.onopen = null\n      this.ws.onmessage = null\n      this.ws.onclose = null\n      this.ws.onerror = null\n      \n      if (this.ws.readyState === WebSocket.OPEN) {\n        this.ws.close()\n      }\n      this.ws = null\n    }\n    \n    store.commit('connection/CLEAR_CONNECTION')\n    console.log('WebSocket连接已断开')\n  }\n\n  /**\n   * 发送消息\n   */\n  send(data) {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      console.warn('WebSocket未连接，消息将加入队列')\n      this.messageQueue.push(data)\n      return false\n    }\n\n    try {\n      const message = typeof data === 'string' ? data : JSON.stringify(data)\n      this.ws.send(message)\n      console.log('发送WebSocket消息:', data)\n      return true\n    } catch (error) {\n      console.error('发送消息失败:', error)\n      return false\n    }\n  }\n\n  /**\n   * 发送登录消息\n   * @param {string} token - JWT token\n   */\n  sendLogin(token) {\n    // 验证token参数\n    if (!token) {\n      console.error('WebSocket登录缺少token参数');\n      return;\n    }\n\n    console.log('发送WebSocket登录消息:', { token: token.substring(0, 20) + '...' });\n    \n    const loginMessage = {\n      seq: generateId(),\n      cmd: WS_COMMANDS.LOGIN,\n      data: {\n        serviceToken: token // 只发送token参数\n      }\n    };\n    \n    this.send(loginMessage);\n  }\n\n  /**\n   * 发送心跳\n   */\n  sendHeartbeat() {\n    const heartbeatData = {\n      seq: generateId(),\n      cmd: WS_COMMANDS.HEARTBEAT,\n      data: {}\n    }\n    return this.send(heartbeatData)\n  }\n\n  /**\n   * 连接打开事件\n   */\n  onOpen() {\n    console.log('WebSocket连接已建立')\n    this.isConnecting = false\n    this.reconnectAttempts = 0\n    \n    store.commit('connection/SET_CONNECTION_STATUS', CONNECTION_STATUS.CONNECTED)\n    store.commit('connection/SET_WEBSOCKET', this.ws)\n    store.commit('connection/RESET_RECONNECT_ATTEMPTS')\n\n    // 发送登录消息 - 使用连接时保存的token\n    const token = this.token || store.state.auth.token\n    if (token) {\n      console.log('WebSocket登录参数验证:', {\n        hasToken: !!token\n      })\n      this.sendLogin(token)\n    } else {\n      console.error('WebSocket登录失败: 缺少token', {\n        savedToken: !!this.token,\n        storeToken: !!store.state.auth.token\n      })\n    }\n\n    // 启动心跳\n    this.startHeartbeat()\n\n    // 发送队列中的消息\n    this.processMessageQueue()\n  }\n\n  /**\n   * 消息接收事件\n   */\n  onMessage(event) {\n    try {\n      const message = JSON.parse(event.data)\n      console.log('收到WebSocket消息:', message)\n      \n      this.handleMessage(message)\n    } catch (error) {\n      console.error('解析WebSocket消息失败:', error)\n    }\n  }\n\n  /**\n   * 连接关闭事件\n   */\n  onClose(event) {\n    console.log('WebSocket连接已关闭', event.code, event.reason)\n    this.isConnecting = false\n    \n    store.commit('connection/SET_CONNECTION_STATUS', CONNECTION_STATUS.DISCONNECTED)\n    this.stopHeartbeat()\n\n    // 如果不是主动断开，尝试重连\n    if (!this.isDestroyed && event.code !== 1000) {\n      this.attemptReconnect()\n    }\n  }\n\n  /**\n   * 连接错误事件\n   */\n  onError(error) {\n    console.error('WebSocket连接错误:', error)\n    this.isConnecting = false\n    store.commit('connection/SET_CONNECTION_STATUS', CONNECTION_STATUS.DISCONNECTED)\n  }\n\n  /**\n   * 处理接收到的消息\n   */\n  handleMessage(message) {\n    const { cmd, response } = message\n\n    switch (cmd) {\n      case WS_COMMANDS.MESSAGE:\n        this.handleChatMessage(response)\n        break\n      case WS_COMMANDS.ENTER:\n        this.handleUserEnter(response)\n        break\n      case WS_COMMANDS.EXIT:\n        this.handleUserExit(response)\n        break\n      case WS_COMMANDS.HEARTBEAT:\n        this.handleHeartbeat(response)\n        break\n      case WS_COMMANDS.LOGIN:\n        this.handleLoginResponse(response)\n        break\n      default:\n        console.log('未处理的消息类型:', cmd)\n    }\n  }\n\n  /**\n   * 处理聊天消息\n   */\n  handleChatMessage(response) {\n    if (!response || !response.data) return\n\n    const { from, to, msg } = response.data\n    const messageObj = {\n      messageID: `ws_${Date.now()}_${from}`,\n      fromUserID: from,\n      toUserID: to || this.userID,\n      content: msg,\n      messageType: 'text',\n      timestamp: new Date().toISOString(),\n      isRead: false\n    }\n\n    // 添加到聊天记录\n    store.dispatch('chat/receiveMessage', {\n      fromUserID: from,\n      message: messageObj\n    })\n  }\n\n  /**\n   * 处理用户进入\n   */\n  handleUserEnter(response) {\n    if (!response || !response.data) return\n\n    const { from } = response.data\n    console.log(`用户 ${from} 加入了聊天室`)\n\n    // 更新好友在线状态\n    store.dispatch('friend/updateFriendOnlineStatus', {\n      userID: from,\n      isOnline: true\n    })\n  }\n\n  /**\n   * 处理用户离开\n   */\n  handleUserExit(response) {\n    if (!response || !response.data) return\n\n    const { from } = response.data\n    console.log(`用户 ${from} 离开了聊天室`)\n\n    // 更新好友在线状态\n    store.dispatch('friend/updateFriendOnlineStatus', {\n      userID: from,\n      isOnline: false\n    })\n  }\n\n  /**\n   * 处理心跳响应\n   */\n  handleHeartbeat(response) {\n    store.commit('connection/SET_LAST_HEARTBEAT', Date.now())\n    console.log('收到心跳响应')\n  }\n\n  /**\n   * 处理登录响应\n   */\n  handleLoginResponse(response) {\n    console.log('登录响应:', response)\n    \n    // 从登录响应中获取userID\n    if (response && response.data && response.data.userID) {\n      this.userID = response.data.userID\n      console.log('WebSocket登录成功，userID:', this.userID)\n      \n      // 更新store中的连接状态\n      store.commit('connection/SET_CONNECTION_STATUS', CONNECTION_STATUS.AUTHENTICATED)\n    } else {\n      console.error('登录响应中缺少userID信息:', response)\n    }\n  }\n\n  /**\n   * 启动心跳\n   */\n  startHeartbeat() {\n    this.stopHeartbeat()\n    \n    this.heartbeatTimer = setInterval(() => {\n      if (!this.sendHeartbeat()) {\n        console.log('心跳发送失败，连接可能已断开')\n        this.stopHeartbeat()\n      }\n    }, this.heartbeatInterval)\n\n    store.commit('connection/SET_HEARTBEAT_INTERVAL', this.heartbeatTimer)\n  }\n\n  /**\n   * 停止心跳\n   */\n  stopHeartbeat() {\n    if (this.heartbeatTimer) {\n      clearInterval(this.heartbeatTimer)\n      this.heartbeatTimer = null\n    }\n    store.commit('connection/SET_HEARTBEAT_INTERVAL', null)\n  }\n\n  /**\n   * 尝试重连\n   */\n  attemptReconnect() {\n    if (this.isDestroyed || this.reconnectAttempts >= this.maxReconnectAttempts) {\n      console.log('达到最大重连次数或服务已销毁，停止重连')\n      return\n    }\n\n    this.reconnectAttempts++\n    const delay = this.reconnectDelay * this.reconnectAttempts\n\n    console.log(`${delay}ms后尝试第${this.reconnectAttempts}次重连...`)\n    store.commit('connection/SET_CONNECTION_STATUS', CONNECTION_STATUS.RECONNECTING)\n    store.commit('connection/INCREMENT_RECONNECT_ATTEMPTS')\n\n    this.reconnectTimer = setTimeout(() => {\n      if (this.isDestroyed) return\n\n      this.connect(this.url, this.token)\n        .then(() => {\n          console.log('重连成功')\n        })\n        .catch(error => {\n          console.error('重连失败:', error)\n          this.attemptReconnect()\n        })\n    }, delay)\n  }\n\n  /**\n   * 停止重连\n   */\n  stopReconnect() {\n    if (this.reconnectTimer) {\n      clearTimeout(this.reconnectTimer)\n      this.reconnectTimer = null\n    }\n  }\n\n  /**\n   * 处理消息队列\n   */\n  processMessageQueue() {\n    while (this.messageQueue.length > 0) {\n      const message = this.messageQueue.shift()\n      this.send(message)\n    }\n  }\n\n  /**\n   * 检查连接状态\n   */\n  isConnected() {\n    return this.ws && this.ws.readyState === WebSocket.OPEN\n  }\n\n  /**\n   * 获取连接状态\n   */\n  getConnectionStatus() {\n    if (!this.ws) return CONNECTION_STATUS.DISCONNECTED\n    \n    switch (this.ws.readyState) {\n      case WebSocket.CONNECTING:\n        return CONNECTION_STATUS.CONNECTING\n      case WebSocket.OPEN:\n        return CONNECTION_STATUS.CONNECTED\n      case WebSocket.CLOSING:\n      case WebSocket.CLOSED:\n      default:\n        return CONNECTION_STATUS.DISCONNECTED\n    }\n  }\n}\n\n// 创建单例实例\nconst webSocketService = new WebSocketService()\n\nexport default webSocketService","import webSocketService from '@/services/websocket'\n\nconst connection = {\n  namespaced: true,\n  state: {\n    status: 'disconnected', // disconnected, connecting, connected, reconnecting\n    ws: null,\n    reconnectAttempts: 0,\n    maxReconnectAttempts: 5,\n    reconnectDelay: 1000,\n    heartbeatInterval: null,\n    lastHeartbeat: null\n  },\n  mutations: {\n    SET_CONNECTION_STATUS(state, status) {\n      state.status = status\n    },\n    SET_WEBSOCKET(state, ws) {\n      state.ws = ws\n    },\n    SET_RECONNECT_ATTEMPTS(state, attempts) {\n      state.reconnectAttempts = attempts\n    },\n    INCREMENT_RECONNECT_ATTEMPTS(state) {\n      state.reconnectAttempts++\n    },\n    RESET_RECONNECT_ATTEMPTS(state) {\n      state.reconnectAttempts = 0\n    },\n    SET_HEARTBEAT_INTERVAL(state, interval) {\n      state.heartbeatInterval = interval\n    },\n    SET_LAST_HEARTBEAT(state, time) {\n      state.lastHeartbeat = time\n    },\n    CLEAR_CONNECTION(state) {\n      state.status = 'disconnected'\n      state.ws = null\n      state.reconnectAttempts = 0\n      if (state.heartbeatInterval) {\n        clearInterval(state.heartbeatInterval)\n        state.heartbeatInterval = null\n      }\n      state.lastHeartbeat = null\n    }\n  },\n  actions: {\n    connect({ commit, dispatch }, { url, token }) {\n      return webSocketService.connect(url, token)\n    },\n\n    disconnect({ commit }) {\n      webSocketService.disconnect()\n    },\n\n    sendMessage({ state }, data) {\n      return webSocketService.send(data)\n    },\n\n  },\n  getters: {\n    isConnected: state => state.status === 'connected',\n    isConnecting: state => state.status === 'connecting',\n    isReconnecting: state => state.status === 'reconnecting',\n    connectionStatus: state => state.status\n  }\n}\n\nexport default connection","import Vue from 'vue'\nimport Vuex from 'vuex'\nimport auth from './modules/auth'\nimport user from './modules/user'\nimport friend from './modules/friend'\nimport chat from './modules/chat'\nimport connection from './modules/connection'\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n  modules: {\n    auth,\n    user,\n    friend,\n    chat,\n    connection\n  },\n  strict: process.env.NODE_ENV !== 'production'\n})","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"login-container\"},[_c('div',{staticClass:\"login-card\"},[_vm._m(0),_c('el-form',{ref:\"loginForm\",staticClass:\"login-form\",attrs:{\"model\":_vm.loginForm,\"rules\":_vm.loginRules},nativeOn:{\"submit\":function($event){$event.preventDefault();return _vm.handleLogin.apply(null, arguments)}}},[_c('el-form-item',{attrs:{\"prop\":\"userID\"}},[_c('el-input',{attrs:{\"type\":\"text\",\"placeholder\":\"请输入用户ID\",\"prefix-icon\":\"el-icon-user\",\"size\":\"large\",\"disabled\":_vm.loading},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.handleLogin.apply(null, arguments)}},model:{value:(_vm.loginForm.userID),callback:function ($$v) {_vm.$set(_vm.loginForm, \"userID\", $$v)},expression:\"loginForm.userID\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"appID\"}},[_c('el-input',{attrs:{\"type\":\"text\",\"placeholder\":\"设备AppID（自动生成）\",\"prefix-icon\":\"el-icon-mobile-phone\",\"size\":\"large\",\"disabled\":_vm.loading,\"readonly\":\"\"},model:{value:(_vm.loginForm.appID),callback:function ($$v) {_vm.$set(_vm.loginForm, \"appID\", $$v)},expression:\"loginForm.appID\"}},[_c('template',{slot:\"append\"},[_c('el-button',{attrs:{\"disabled\":_vm.loading,\"icon\":\"el-icon-refresh\",\"title\":\"重新生成AppID\"},on:{\"click\":_vm.regenerateAppId}},[_vm._v(\" 重新生成 \")])],1)],2)],1),_c('el-form-item',[_c('el-button',{staticClass:\"login-button\",attrs:{\"type\":\"primary\",\"size\":\"large\",\"loading\":_vm.loading,\"disabled\":!_vm.loginForm.userID.trim()},on:{\"click\":_vm.handleLogin}},[_vm._v(\" \"+_vm._s(_vm.loading ? '登录中...' : '登录')+\" \")])],1)],1),_vm._m(1),_c('div',{staticClass:\"quick-login\"},[_c('p',[_vm._v(\"快速登录：\")]),_c('div',{staticClass:\"quick-buttons\"},_vm._l((_vm.quickLoginIds),function(id){return _c('el-button',{key:id,attrs:{\"size\":\"small\",\"disabled\":_vm.loading},on:{\"click\":function($event){return _vm.quickLogin(id)}}},[_vm._v(\" 用户\"+_vm._s(id)+\" \")])}),1)])],1),_vm._m(2)])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"login-header\"},[_c('h1',[_vm._v(\"GoWebSocket IM\")]),_c('p',[_vm._v(\"分布式即时通讯系统\")])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"login-tips\"},[_c('p',[_vm._v(\"提示：\")]),_c('ul',[_c('li',[_vm._v(\"首次使用会自动注册账号\")]),_c('li',[_vm._v(\"输入任意用户ID即可开始聊天\")]),_c('li',[_vm._v(\"可以尝试输入：10001, 10002, 10003 等\")])])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"footer\"},[_c('p',[_vm._v(\"© 2024 GoWebSocket IM - 基于Go + Vue2的即时通讯系统\")])])\n}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"login-container\">\n    <div class=\"login-card\">\n      <div class=\"login-header\">\n        <h1>GoWebSocket IM</h1>\n        <p>分布式即时通讯系统</p>\n      </div>\n      \n      <el-form \n        ref=\"loginForm\" \n        :model=\"loginForm\" \n        :rules=\"loginRules\" \n        class=\"login-form\"\n        @submit.native.prevent=\"handleLogin\"\n      >\n        <el-form-item prop=\"userID\">\n          <el-input\n            v-model=\"loginForm.userID\"\n            type=\"text\"\n            placeholder=\"请输入用户ID\"\n            prefix-icon=\"el-icon-user\"\n            size=\"large\"\n            :disabled=\"loading\"\n            @keyup.enter.native=\"handleLogin\"\n          />\n        </el-form-item>\n        \n        <el-form-item prop=\"appID\">\n          <el-input\n            v-model=\"loginForm.appID\"\n            type=\"text\"\n            placeholder=\"设备AppID（自动生成）\"\n            prefix-icon=\"el-icon-mobile-phone\"\n            size=\"large\"\n            :disabled=\"loading\"\n            readonly\n          >\n            <template slot=\"append\">\n              <el-button \n                @click=\"regenerateAppId\" \n                :disabled=\"loading\"\n                icon=\"el-icon-refresh\"\n                title=\"重新生成AppID\"\n              >\n                重新生成\n              </el-button>\n            </template>\n          </el-input>\n        </el-form-item>\n        \n        <el-form-item>\n          <el-button\n            type=\"primary\"\n            size=\"large\"\n            :loading=\"loading\"\n            :disabled=\"!loginForm.userID.trim()\"\n            class=\"login-button\"\n            @click=\"handleLogin\"\n          >\n            {{ loading ? '登录中...' : '登录' }}\n          </el-button>\n        </el-form-item>\n      </el-form>\n      \n      <div class=\"login-tips\">\n        <p>提示：</p>\n        <ul>\n          <li>首次使用会自动注册账号</li>\n          <li>输入任意用户ID即可开始聊天</li>\n          <li>可以尝试输入：10001, 10002, 10003 等</li>\n        </ul>\n      </div>\n      \n      <div class=\"quick-login\">\n        <p>快速登录：</p>\n        <div class=\"quick-buttons\">\n          <el-button \n            v-for=\"id in quickLoginIds\" \n            :key=\"id\"\n            size=\"small\" \n            @click=\"quickLogin(id)\"\n            :disabled=\"loading\"\n          >\n            用户{{ id }}\n          </el-button>\n        </div>\n      </div>\n    </div>\n    \n    <div class=\"footer\">\n      <p>&copy; 2024 GoWebSocket IM - 基于Go + Vue2的即时通讯系统</p>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex'\nimport { generateUserId, generateAppId } from '@/utils/helpers'\nimport webSocketService from '@/services/websocket'\nimport { WS_URL } from '@/utils/constants'\n\nexport default {\n  name: 'LoginPage',\n  data() {\n    return {\n      loginForm: {\n        userID: '',\n        appID: ''\n      },\n      loginRules: {\n        userID: [\n          { required: true, message: '请输入用户ID', trigger: 'blur' },\n          { min: 3, max: 20, message: '用户ID长度在 3 到 20 个字符', trigger: 'blur' }\n        ],\n        appID: [\n          { required: true, message: 'AppID不能为空', trigger: 'blur' }\n        ]\n      },\n      quickLoginIds: [10001, 10002, 10003, 10004, 10005]\n    }\n  },\n  computed: {\n    ...mapGetters('auth', ['loginLoading']),\n    loading() {\n      return this.loginLoading\n    }\n  },\n  mounted() {\n    // 如果已经登录，直接跳转\n    if (this.$store.getters['auth/isLoggedIn']) {\n      this.$router.push('/chat')\n    }\n    \n    // 自动生成一个用户ID作为默认值\n    this.loginForm.userID = generateUserId().toString()\n    // 自动生成AppID\n    this.loginForm.appID = generateAppId()\n  },\n  methods: {\n    ...mapActions('auth', ['login']),\n    \n    /**\n     * 处理用户登录\n     */\n    async handleLogin() {\n      try {\n        // 表单验证\n        await this.$refs.loginForm.validate()\n        \n        // 执行登录\n        const result = await this.login({\n          userID: this.loginForm.userID.trim(),\n          appID: this.loginForm.appID\n        })\n        \n        if (result.success) {\n          this.$message.success(\n            result.isNewUser ? '注册并登录成功！' : '登录成功！'\n          )\n          \n          // 登录成功后自动连接WebSocket\n          try {\n            await webSocketService.connect(\n              WS_URL, \n              this.$store.state.auth.token // 只传递token\n            )\n            console.log('WebSocket连接成功')\n          } catch (wsError) {\n            console.error('WebSocket连接失败:', wsError)\n            // WebSocket连接失败不影响登录流程\n          }\n          \n          // 跳转到聊天室\n          const redirect = this.$route.query.redirect || '/chat'\n          this.$router.push(redirect)\n        } else {\n          this.$message.error(result.error || '登录失败')\n        }\n      } catch (error) {\n        console.error('登录失败:', error)\n      }\n    },\n    \n    /**\n     * 快速登录\n     * @param {number} userID - 用户ID\n     */\n    quickLogin(userID) {\n      this.loginForm.userID = userID.toString()\n      this.handleLogin()\n    },\n    \n    /**\n     * 重新生成AppID\n     */\n    regenerateAppId() {\n      this.loginForm.appID = generateAppId()\n      this.$message.success('AppID已重新生成')\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.login-container {\n  min-height: 100vh;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n}\n\n.login-card {\n  background: white;\n  border-radius: 8px;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);\n  padding: 40px;\n  width: 100%;\n  max-width: 400px;\n  text-align: center;\n}\n\n.login-header {\n  margin-bottom: 30px;\n  \n  h1 {\n    color: #303133;\n    font-size: 28px;\n    font-weight: 600;\n    margin-bottom: 8px;\n  }\n  \n  p {\n    color: #909399;\n    font-size: 14px;\n  }\n}\n\n.login-form {\n  margin-bottom: 30px;\n}\n\n.login-button {\n  width: 100%;\n  height: 48px;\n  font-size: 16px;\n  border-radius: 6px;\n}\n\n.login-tips {\n  text-align: left;\n  background: #f8f9fa;\n  border-radius: 6px;\n  padding: 16px;\n  margin-bottom: 20px;\n  \n  p {\n    font-weight: 500;\n    color: #606266;\n    margin-bottom: 8px;\n  }\n  \n  ul {\n    list-style: none;\n    padding: 0;\n    \n    li {\n      color: #909399;\n      font-size: 13px;\n      line-height: 1.6;\n      position: relative;\n      padding-left: 16px;\n      margin-bottom: 4px;\n      \n      &:before {\n        content: '•';\n        color: #409EFF;\n        position: absolute;\n        left: 0;\n      }\n    }\n  }\n}\n\n.quick-login {\n  text-align: left;\n  \n  p {\n    font-weight: 500;\n    color: #606266;\n    margin-bottom: 12px;\n    font-size: 14px;\n  }\n  \n  .quick-buttons {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n    \n    .el-button {\n      flex: 1;\n      min-width: 0;\n    }\n  }\n}\n\n.footer {\n  margin-top: 30px;\n  color: rgba(255, 255, 255, 0.8);\n  font-size: 12px;\n  text-align: center;\n}\n\n// 响应式设计\n@media (max-width: 480px) {\n  .login-card {\n    padding: 30px 20px;\n    margin: 0 10px;\n  }\n  \n  .login-header h1 {\n    font-size: 24px;\n  }\n}\n</style>","import mod from \"-!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./LoginPage.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./LoginPage.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./LoginPage.vue?vue&type=template&id=0496e318&scoped=true\"\nimport script from \"./LoginPage.vue?vue&type=script&lang=js\"\nexport * from \"./LoginPage.vue?vue&type=script&lang=js\"\nimport style0 from \"./LoginPage.vue?vue&type=style&index=0&id=0496e318&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0496e318\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"chat-room\"},[_c('div',{staticClass:\"sidebar\",class:{ 'show': _vm.showSidebar }},[_c('div',{staticClass:\"user-header\"},[_c('div',{staticClass:\"user-info\"},[_c('div',{staticClass:\"avatar\"},[(_vm.currentUser?.avatar)?_c('img',{attrs:{\"src\":_vm.currentUser.avatar,\"alt\":_vm.currentUser.nickname}}):_c('span',[_vm._v(_vm._s(_vm.currentUser?.nickname?.charAt(0) || 'U'))])]),_c('div',{staticClass:\"user-details\"},[_c('div',{staticClass:\"nickname\"},[_vm._v(_vm._s(_vm.currentUser?.nickname || '未知用户'))]),_c('div',{staticClass:\"status\",class:_vm.connectionStatus},[_c('i',{staticClass:\"status-dot\"}),_vm._v(\" \"+_vm._s(_vm.statusText)+\" \")])])]),_c('div',{staticClass:\"user-actions\"},[_c('el-dropdown',{on:{\"command\":_vm.handleUserAction}},[_c('span',{staticClass:\"el-dropdown-link\"},[_c('i',{staticClass:\"el-icon-more\"})]),_c('el-dropdown-menu',{attrs:{\"slot\":\"dropdown\"},slot:\"dropdown\"},[_c('el-dropdown-item',{attrs:{\"command\":\"addFriend\"}},[_vm._v(\"添加好友\")]),_c('el-dropdown-item',{attrs:{\"command\":\"settings\"}},[_vm._v(\"设置\")]),_c('el-dropdown-item',{attrs:{\"command\":\"logout\"}},[_vm._v(\"退出登录\")])],1)],1)],1)]),_c('FriendList',{attrs:{\"friends\":_vm.friendList,\"selected-friend\":_vm.selectedFriend,\"loading\":_vm.loadingFriends},on:{\"select-friend\":_vm.handleSelectFriend,\"add-friend\":_vm.handleAddFriend}})],1),_c('div',{staticClass:\"main-content\"},[(_vm.selectedFriend)?_c('ChatWindow',{attrs:{\"friend\":_vm.selectedFriend,\"messages\":_vm.currentMessages,\"loading\":_vm.loadingHistory,\"sending\":_vm.sendingMessage},on:{\"send-message\":_vm.handleSendMessage,\"load-more\":_vm.handleLoadMore}}):_c('div',{staticClass:\"welcome-screen\"},[_c('div',{staticClass:\"welcome-content\"},[_c('i',{staticClass:\"el-icon-chat-line-round welcome-icon\"}),_c('h3',[_vm._v(\"欢迎使用 GoWebSocket IM\")]),_c('p',[_vm._v(\"选择一个好友开始聊天\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleAddFriend}},[_c('i',{staticClass:\"el-icon-plus\"}),_vm._v(\" 添加好友 \")])],1)])],1),(_vm.showSidebar)?_c('div',{staticClass:\"sidebar-overlay\",on:{\"click\":function($event){_vm.showSidebar = false}}}):_vm._e(),_c('el-dialog',{attrs:{\"title\":\"添加好友\",\"visible\":_vm.addFriendDialog,\"width\":\"400px\"},on:{\"update:visible\":function($event){_vm.addFriendDialog=$event},\"close\":_vm.resetAddFriendForm}},[_c('el-form',{ref:\"addFriendForm\",attrs:{\"model\":_vm.addFriendForm,\"rules\":_vm.addFriendRules}},[_c('el-form-item',{attrs:{\"label\":\"用户ID\",\"prop\":\"friendID\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入要添加的用户ID\"},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.confirmAddFriend.apply(null, arguments)}},model:{value:(_vm.addFriendForm.friendID),callback:function ($$v) {_vm.$set(_vm.addFriendForm, \"friendID\", $$v)},expression:\"addFriendForm.friendID\"}})],1)],1),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.addFriendDialog = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.addingFriend},on:{\"click\":_vm.confirmAddFriend}},[_vm._v(\" \"+_vm._s(_vm.addingFriend ? '添加中...' : '确 定')+\" \")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"friend-list\"},[_c('div',{staticClass:\"search-section\"},[_c('el-input',{attrs:{\"placeholder\":\"搜索好友...\",\"prefix-icon\":\"el-icon-search\",\"size\":\"small\",\"clearable\":\"\"},on:{\"input\":_vm.handleSearch},model:{value:(_vm.searchKeyword),callback:function ($$v) {_vm.searchKeyword=$$v},expression:\"searchKeyword\"}})],1),(_vm.onlineFriends.length > 0)?_c('div',{staticClass:\"friend-section\"},[_c('div',{staticClass:\"section-header\"},[_c('span',{staticClass:\"section-title\"},[_vm._v(\"在线好友 (\"+_vm._s(_vm.onlineFriends.length)+\")\")]),_c('i',{staticClass:\"el-icon-arrow-down toggle-icon\",class:{ 'collapsed': !_vm.showOnline },on:{\"click\":function($event){_vm.showOnline = !_vm.showOnline}}})]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showOnline),expression:\"showOnline\"}],staticClass:\"friend-items\"},_vm._l((_vm.filteredOnlineFriends),function(friend){return _c('div',{key:friend.userID,staticClass:\"friend-item\",class:{ 'active': _vm.selectedFriend?.userID === friend.userID },on:{\"click\":function($event){return _vm.$emit('select-friend', friend)}}},[_c('div',{staticClass:\"avatar-container\"},[_c('div',{staticClass:\"avatar\"},[(friend.avatar)?_c('img',{attrs:{\"src\":friend.avatar,\"alt\":friend.nickname}}):_c('span',[_vm._v(_vm._s(friend.nickname?.charAt(0) || 'U'))])]),_c('div',{staticClass:\"online-status online\"})]),_c('div',{staticClass:\"friend-info\"},[_c('div',{staticClass:\"friend-name\"},[_vm._v(_vm._s(friend.nickname))]),_c('div',{staticClass:\"last-seen\"},[_vm._v(\"在线\")])]),_c('div',{staticClass:\"friend-actions\"},[(friend.unreadCount > 0)?_c('el-badge',{staticClass:\"unread-badge\",attrs:{\"value\":friend.unreadCount > 99 ? '99+' : friend.unreadCount}}):_vm._e()],1)])}),0)]):_vm._e(),(_vm.offlineFriends.length > 0)?_c('div',{staticClass:\"friend-section\"},[_c('div',{staticClass:\"section-header\"},[_c('span',{staticClass:\"section-title\"},[_vm._v(\"离线好友 (\"+_vm._s(_vm.offlineFriends.length)+\")\")]),_c('i',{staticClass:\"el-icon-arrow-down toggle-icon\",class:{ 'collapsed': !_vm.showOffline },on:{\"click\":function($event){_vm.showOffline = !_vm.showOffline}}})]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showOffline),expression:\"showOffline\"}],staticClass:\"friend-items\"},_vm._l((_vm.filteredOfflineFriends),function(friend){return _c('div',{key:friend.userID,staticClass:\"friend-item\",class:{ 'active': _vm.selectedFriend?.userID === friend.userID },on:{\"click\":function($event){return _vm.$emit('select-friend', friend)}}},[_c('div',{staticClass:\"avatar-container\"},[_c('div',{staticClass:\"avatar\"},[(friend.avatar)?_c('img',{attrs:{\"src\":friend.avatar,\"alt\":friend.nickname}}):_c('span',[_vm._v(_vm._s(friend.nickname?.charAt(0) || 'U'))])]),_c('div',{staticClass:\"online-status offline\"})]),_c('div',{staticClass:\"friend-info\"},[_c('div',{staticClass:\"friend-name\"},[_vm._v(_vm._s(friend.nickname))]),_c('div',{staticClass:\"last-seen\"},[_vm._v(_vm._s(_vm.formatLastSeen(friend.lastSeen)))])]),_c('div',{staticClass:\"friend-actions\"},[(friend.unreadCount > 0)?_c('el-badge',{staticClass:\"unread-badge\",attrs:{\"value\":friend.unreadCount > 99 ? '99+' : friend.unreadCount}}):_vm._e()],1)])}),0)]):_vm._e(),(_vm.friends.length === 0 && !_vm.loading)?_c('div',{staticClass:\"empty-state\"},[_c('i',{staticClass:\"el-icon-user empty-icon\"}),_c('p',[_vm._v(\"暂无好友\")]),_c('el-button',{attrs:{\"type\":\"text\"},on:{\"click\":function($event){return _vm.$emit('add-friend')}}},[_c('i',{staticClass:\"el-icon-plus\"}),_vm._v(\" 添加好友 \")])],1):_vm._e(),(_vm.searchKeyword && _vm.filteredFriends.length === 0)?_c('div',{staticClass:\"empty-state\"},[_c('i',{staticClass:\"el-icon-search empty-icon\"}),_c('p',[_vm._v(\"未找到相关好友\")])]):_vm._e(),(_vm.loading)?_c('div',{staticClass:\"loading-state\"},[_c('i',{staticClass:\"el-icon-loading\"}),_c('p',[_vm._v(\"加载中...\")])]):_vm._e(),(_vm.friends.length > 0)?_c('div',{staticClass:\"add-friend-btn\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"icon\":\"el-icon-plus\"},on:{\"click\":function($event){return _vm.$emit('add-friend')}}},[_vm._v(\" 添加好友 \")])],1):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"friend-list\">\n    <!-- 搜索框 -->\n    <div class=\"search-section\">\n      <el-input\n        v-model=\"searchKeyword\"\n        placeholder=\"搜索好友...\"\n        prefix-icon=\"el-icon-search\"\n        size=\"small\"\n        clearable\n        @input=\"handleSearch\"\n      />\n    </div>\n\n    <!-- 在线好友 -->\n    <div v-if=\"onlineFriends.length > 0\" class=\"friend-section\">\n      <div class=\"section-header\">\n        <span class=\"section-title\">在线好友 ({{ onlineFriends.length }})</span>\n        <i \n          class=\"el-icon-arrow-down toggle-icon\"\n          :class=\"{ 'collapsed': !showOnline }\"\n          @click=\"showOnline = !showOnline\"\n        ></i>\n      </div>\n      <div v-show=\"showOnline\" class=\"friend-items\">\n        <div\n          v-for=\"friend in filteredOnlineFriends\"\n          :key=\"friend.userID\"\n          class=\"friend-item\"\n          :class=\"{ 'active': selectedFriend?.userID === friend.userID }\"\n          @click=\"$emit('select-friend', friend)\"\n        >\n          <div class=\"avatar-container\">\n            <div class=\"avatar\">\n              <img v-if=\"friend.avatar\" :src=\"friend.avatar\" :alt=\"friend.nickname\" />\n              <span v-else>{{ friend.nickname?.charAt(0) || 'U' }}</span>\n            </div>\n            <div class=\"online-status online\"></div>\n          </div>\n          <div class=\"friend-info\">\n            <div class=\"friend-name\">{{ friend.nickname }}</div>\n            <div class=\"last-seen\">在线</div>\n          </div>\n          <div class=\"friend-actions\">\n            <el-badge \n              v-if=\"friend.unreadCount > 0\" \n              :value=\"friend.unreadCount > 99 ? '99+' : friend.unreadCount\"\n              class=\"unread-badge\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 离线好友 -->\n    <div v-if=\"offlineFriends.length > 0\" class=\"friend-section\">\n      <div class=\"section-header\">\n        <span class=\"section-title\">离线好友 ({{ offlineFriends.length }})</span>\n        <i \n          class=\"el-icon-arrow-down toggle-icon\"\n          :class=\"{ 'collapsed': !showOffline }\"\n          @click=\"showOffline = !showOffline\"\n        ></i>\n      </div>\n      <div v-show=\"showOffline\" class=\"friend-items\">\n        <div\n          v-for=\"friend in filteredOfflineFriends\"\n          :key=\"friend.userID\"\n          class=\"friend-item\"\n          :class=\"{ 'active': selectedFriend?.userID === friend.userID }\"\n          @click=\"$emit('select-friend', friend)\"\n        >\n          <div class=\"avatar-container\">\n            <div class=\"avatar\">\n              <img v-if=\"friend.avatar\" :src=\"friend.avatar\" :alt=\"friend.nickname\" />\n              <span v-else>{{ friend.nickname?.charAt(0) || 'U' }}</span>\n            </div>\n            <div class=\"online-status offline\"></div>\n          </div>\n          <div class=\"friend-info\">\n            <div class=\"friend-name\">{{ friend.nickname }}</div>\n            <div class=\"last-seen\">{{ formatLastSeen(friend.lastSeen) }}</div>\n          </div>\n          <div class=\"friend-actions\">\n            <el-badge \n              v-if=\"friend.unreadCount > 0\" \n              :value=\"friend.unreadCount > 99 ? '99+' : friend.unreadCount\"\n              class=\"unread-badge\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 空状态 -->\n    <div v-if=\"friends.length === 0 && !loading\" class=\"empty-state\">\n      <i class=\"el-icon-user empty-icon\"></i>\n      <p>暂无好友</p>\n      <el-button type=\"text\" @click=\"$emit('add-friend')\">\n        <i class=\"el-icon-plus\"></i>\n        添加好友\n      </el-button>\n    </div>\n\n    <!-- 搜索无结果 -->\n    <div v-if=\"searchKeyword && filteredFriends.length === 0\" class=\"empty-state\">\n      <i class=\"el-icon-search empty-icon\"></i>\n      <p>未找到相关好友</p>\n    </div>\n\n    <!-- 加载状态 -->\n    <div v-if=\"loading\" class=\"loading-state\">\n      <i class=\"el-icon-loading\"></i>\n      <p>加载中...</p>\n    </div>\n\n    <!-- 添加好友按钮 -->\n    <div v-if=\"friends.length > 0\" class=\"add-friend-btn\">\n      <el-button \n        type=\"primary\" \n        size=\"small\" \n        icon=\"el-icon-plus\"\n        @click=\"$emit('add-friend')\"\n      >\n        添加好友\n      </el-button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { formatTime } from '@/utils/helpers'\nimport { debounce } from '@/utils/helpers'\n\nexport default {\n  name: 'FriendList',\n  props: {\n    friends: {\n      type: Array,\n      default: () => []\n    },\n    selectedFriend: {\n      type: Object,\n      default: null\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      searchKeyword: '',\n      showOnline: true,\n      showOffline: true,\n      filteredFriends: []\n    }\n  },\n  computed: {\n    onlineFriends() {\n      return this.friends.filter(friend => friend.isOnline)\n    },\n    offlineFriends() {\n      return this.friends.filter(friend => !friend.isOnline)\n    },\n    filteredOnlineFriends() {\n      return this.filterFriends(this.onlineFriends)\n    },\n    filteredOfflineFriends() {\n      return this.filterFriends(this.offlineFriends)\n    }\n  },\n  watch: {\n    friends: {\n      handler() {\n        this.updateFilteredFriends()\n      },\n      immediate: true\n    }\n  },\n  created() {\n    // 创建防抖搜索函数\n    this.debouncedSearch = debounce(this.updateFilteredFriends, 300)\n  },\n  methods: {\n    handleSearch() {\n      this.debouncedSearch()\n    },\n\n    updateFilteredFriends() {\n      this.filteredFriends = this.filterFriends(this.friends)\n    },\n\n    filterFriends(friendList) {\n      if (!this.searchKeyword.trim()) {\n        return friendList\n      }\n      \n      const keyword = this.searchKeyword.toLowerCase()\n      return friendList.filter(friend => {\n        return friend.nickname?.toLowerCase().includes(keyword) ||\n               friend.userID?.toLowerCase().includes(keyword)\n      })\n    },\n\n    formatLastSeen(lastSeen) {\n      if (!lastSeen) return '很久之前'\n      return formatTime(lastSeen)\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.friend-list {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  height: 0; // 使flex生效\n}\n\n.search-section {\n  padding: 16px;\n  border-bottom: 1px solid #f2f6fc;\n}\n\n.friend-section {\n  .section-header {\n    padding: 12px 16px 8px;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    cursor: pointer;\n    \n    &:hover {\n      background: #f8f9fa;\n    }\n  }\n\n  .section-title {\n    font-size: 12px;\n    color: #909399;\n    font-weight: 500;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n\n  .toggle-icon {\n    font-size: 12px;\n    color: #c0c4cc;\n    transition: transform 0.3s;\n    \n    &.collapsed {\n      transform: rotate(-90deg);\n    }\n  }\n}\n\n.friend-items {\n  overflow-y: auto;\n  max-height: 300px;\n}\n\n.friend-item {\n  padding: 12px 16px;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  transition: background-color 0.2s;\n  border-bottom: 1px solid #f8f9fa;\n\n  &:hover {\n    background: #f8f9fa;\n  }\n\n  &.active {\n    background: #409eff;\n    color: white;\n\n    .friend-name,\n    .last-seen {\n      color: white;\n    }\n\n    .online-status.offline {\n      background: rgba(255, 255, 255, 0.6);\n    }\n  }\n\n  &:last-child {\n    border-bottom: none;\n  }\n}\n\n.avatar-container {\n  position: relative;\n  margin-right: 12px;\n  flex-shrink: 0;\n}\n\n.avatar {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background: #409eff;\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 16px;\n  font-weight: 500;\n\n  img {\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    object-fit: cover;\n  }\n}\n\n.online-status {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  width: 10px;\n  height: 10px;\n  border-radius: 50%;\n  border: 2px solid white;\n\n  &.online {\n    background: #67c23a;\n  }\n\n  &.offline {\n    background: #c0c4cc;\n  }\n}\n\n.friend-info {\n  flex: 1;\n  min-width: 0;\n}\n\n.friend-name {\n  font-size: 14px;\n  font-weight: 500;\n  color: #303133;\n  margin-bottom: 4px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.last-seen {\n  font-size: 12px;\n  color: #909399;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.friend-actions {\n  flex-shrink: 0;\n}\n\n.unread-badge {\n  :deep(.el-badge__content) {\n    background: #f56c6c;\n    border: none;\n    font-size: 10px;\n    height: 16px;\n    line-height: 16px;\n    padding: 0 5px;\n    min-width: 16px;\n  }\n}\n\n.empty-state,\n.loading-state {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: #909399;\n  text-align: center;\n  padding: 40px 20px;\n\n  .empty-icon {\n    font-size: 48px;\n    margin-bottom: 16px;\n    color: #c0c4cc;\n  }\n\n  p {\n    margin-bottom: 16px;\n    font-size: 14px;\n  }\n}\n\n.add-friend-btn {\n  padding: 16px;\n  border-top: 1px solid #f2f6fc;\n  text-align: center;\n\n  .el-button {\n    width: 100%;\n  }\n}\n\n// 滚动条样式\n.friend-items::-webkit-scrollbar {\n  width: 4px;\n}\n\n.friend-items::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.friend-items::-webkit-scrollbar-thumb {\n  background: #dcdfe6;\n  border-radius: 2px;\n}\n\n.friend-items::-webkit-scrollbar-thumb:hover {\n  background: #c0c4cc;\n}\n</style>","import mod from \"-!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FriendList.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FriendList.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./FriendList.vue?vue&type=template&id=3bec9ebf&scoped=true\"\nimport script from \"./FriendList.vue?vue&type=script&lang=js\"\nexport * from \"./FriendList.vue?vue&type=script&lang=js\"\nimport style0 from \"./FriendList.vue?vue&type=style&index=0&id=3bec9ebf&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3bec9ebf\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"chat-window\"},[_c('div',{staticClass:\"chat-header\"},[_c('div',{staticClass:\"friend-info\"},[_c('div',{staticClass:\"avatar\"},[(_vm.friend.avatar)?_c('img',{attrs:{\"src\":_vm.friend.avatar,\"alt\":_vm.friend.nickname}}):_c('span',[_vm._v(_vm._s(_vm.friend.nickname?.charAt(0) || 'U'))])]),_c('div',{staticClass:\"friend-details\"},[_c('div',{staticClass:\"friend-name\"},[_vm._v(_vm._s(_vm.friend.nickname))]),_c('div',{staticClass:\"friend-status\",class:{ 'online': _vm.friend.isOnline }},[_c('i',{staticClass:\"status-dot\"}),_vm._v(\" \"+_vm._s(_vm.friend.isOnline ? '在线' : '离线')+\" \")])])]),_c('div',{staticClass:\"chat-actions\"},[_c('el-button',{attrs:{\"size\":\"mini\",\"icon\":\"el-icon-more\",\"circle\":\"\"},on:{\"click\":_vm.showChatMenu}})],1)]),_c('div',{ref:\"messageList\",staticClass:\"message-list\",on:{\"scroll\":_vm.handleScroll}},[(_vm.loading)?_c('div',{staticClass:\"loading-more\"},[_c('i',{staticClass:\"el-icon-loading\"}),_c('span',[_vm._v(\"加载中...\")])]):_vm._e(),_vm._l((_vm.messages),function(message){return _c('div',{key:message.messageID,staticClass:\"message-item\",class:{ 'own': _vm.isOwnMessage(message) }},[_c('div',{staticClass:\"message-avatar\"},[_c('div',{staticClass:\"avatar\"},[(_vm.getMessageAvatar(message))?_c('img',{attrs:{\"src\":_vm.getMessageAvatar(message)}}):_c('span',[_vm._v(_vm._s(_vm.getMessageNickname(message)?.charAt(0) || 'U'))])])]),_c('div',{staticClass:\"message-content\"},[_c('div',{staticClass:\"message-info\"},[_c('span',{staticClass:\"sender-name\"},[_vm._v(_vm._s(_vm.getMessageNickname(message)))]),_c('span',{staticClass:\"send-time\"},[_vm._v(_vm._s(_vm.formatMessageTime(message.timestamp)))])]),_c('div',{staticClass:\"message-bubble\",class:{ 'own': _vm.isOwnMessage(message) }},[_c('div',{staticClass:\"bubble-content\"},[_vm._v(\" \"+_vm._s(message.content)+\" \")])])])])}),(_vm.messages.length === 0 && !_vm.loading)?_c('div',{staticClass:\"empty-messages\"},[_c('i',{staticClass:\"el-icon-chat-dot-round\"}),_c('p',[_vm._v(\"暂无聊天记录，发送第一条消息开始聊天吧！\")])]):_vm._e()],2),_c('div',{staticClass:\"message-input\"},[_c('div',{staticClass:\"input-toolbar\"},[_c('el-button',{attrs:{\"size\":\"mini\",\"icon\":\"el-icon-picture\",\"circle\":\"\",\"title\":\"发送图片\"}}),_c('el-button',{attrs:{\"size\":\"mini\",\"icon\":\"el-icon-paperclip\",\"circle\":\"\",\"title\":\"发送文件\"}}),_c('el-button',{attrs:{\"size\":\"mini\",\"icon\":\"el-icon-chat-dot-square\",\"circle\":\"\",\"title\":\"表情\"}})],1),_c('div',{staticClass:\"input-area\"},[_c('el-input',{ref:\"messageInput\",attrs:{\"type\":\"textarea\",\"rows\":3,\"placeholder\":\"输入消息内容，按 Ctrl+Enter 发送\",\"resize\":\"none\",\"disabled\":_vm.sending},nativeOn:{\"keydown\":function($event){return _vm.handleKeyDown.apply(null, arguments)}},model:{value:(_vm.messageContent),callback:function ($$v) {_vm.messageContent=$$v},expression:\"messageContent\"}}),_c('div',{staticClass:\"input-actions\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"loading\":_vm.sending,\"disabled\":!_vm.messageContent.trim()},on:{\"click\":_vm.sendMessage}},[_vm._v(\" \"+_vm._s(_vm.sending ? '发送中...' : '发送')+\" \")])],1)],1)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"chat-window\">\n    <!-- 聊天头部 -->\n    <div class=\"chat-header\">\n      <div class=\"friend-info\">\n        <div class=\"avatar\">\n          <img v-if=\"friend.avatar\" :src=\"friend.avatar\" :alt=\"friend.nickname\" />\n          <span v-else>{{ friend.nickname?.charAt(0) || 'U' }}</span>\n        </div>\n        <div class=\"friend-details\">\n          <div class=\"friend-name\">{{ friend.nickname }}</div>\n          <div class=\"friend-status\" :class=\"{ 'online': friend.isOnline }\">\n            <i class=\"status-dot\"></i>\n            {{ friend.isOnline ? '在线' : '离线' }}\n          </div>\n        </div>\n      </div>\n      <div class=\"chat-actions\">\n        <el-button size=\"mini\" icon=\"el-icon-more\" circle @click=\"showChatMenu\"></el-button>\n      </div>\n    </div>\n\n    <!-- 消息列表 -->\n    <div class=\"message-list\" ref=\"messageList\" @scroll=\"handleScroll\">\n      <!-- 加载更多提示 -->\n      <div v-if=\"loading\" class=\"loading-more\">\n        <i class=\"el-icon-loading\"></i>\n        <span>加载中...</span>\n      </div>\n\n      <!-- 消息项 -->\n      <div\n        v-for=\"message in messages\"\n        :key=\"message.messageID\"\n        class=\"message-item\"\n        :class=\"{ 'own': isOwnMessage(message) }\"\n      >\n        <div class=\"message-avatar\">\n          <div class=\"avatar\">\n            <img v-if=\"getMessageAvatar(message)\" :src=\"getMessageAvatar(message)\" />\n            <span v-else>{{ getMessageNickname(message)?.charAt(0) || 'U' }}</span>\n          </div>\n        </div>\n        <div class=\"message-content\">\n          <div class=\"message-info\">\n            <span class=\"sender-name\">{{ getMessageNickname(message) }}</span>\n            <span class=\"send-time\">{{ formatMessageTime(message.timestamp) }}</span>\n          </div>\n          <div class=\"message-bubble\" :class=\"{ 'own': isOwnMessage(message) }\">\n            <div class=\"bubble-content\">\n              {{ message.content }}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- 空状态 -->\n      <div v-if=\"messages.length === 0 && !loading\" class=\"empty-messages\">\n        <i class=\"el-icon-chat-dot-round\"></i>\n        <p>暂无聊天记录，发送第一条消息开始聊天吧！</p>\n      </div>\n    </div>\n\n    <!-- 消息输入区 -->\n    <div class=\"message-input\">\n      <div class=\"input-toolbar\">\n        <el-button size=\"mini\" icon=\"el-icon-picture\" circle title=\"发送图片\"></el-button>\n        <el-button size=\"mini\" icon=\"el-icon-paperclip\" circle title=\"发送文件\"></el-button>\n        <el-button size=\"mini\" icon=\"el-icon-chat-dot-square\" circle title=\"表情\"></el-button>\n      </div>\n      <div class=\"input-area\">\n        <el-input\n          ref=\"messageInput\"\n          v-model=\"messageContent\"\n          type=\"textarea\"\n          :rows=\"3\"\n          placeholder=\"输入消息内容，按 Ctrl+Enter 发送\"\n          resize=\"none\"\n          :disabled=\"sending\"\n          @keydown.native=\"handleKeyDown\"\n        />\n        <div class=\"input-actions\">\n          <el-button\n            type=\"primary\"\n            size=\"small\"\n            :loading=\"sending\"\n            :disabled=\"!messageContent.trim()\"\n            @click=\"sendMessage\"\n          >\n            {{ sending ? '发送中...' : '发送' }}\n          </el-button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nimport { formatMessageTime, scrollToBottom, isScrolledToBottom } from '@/utils/helpers'\n\nexport default {\n  name: 'ChatWindow',\n  props: {\n    friend: {\n      type: Object,\n      required: true\n    },\n    messages: {\n      type: Array,\n      default: () => []\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    },\n    sending: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      messageContent: '',\n      autoScroll: true,\n      lastMessageCount: 0\n    }\n  },\n  computed: {\n    ...mapGetters('auth', ['currentUser'])\n  },\n  watch: {\n    messages: {\n      handler(newMessages) {\n        this.$nextTick(() => {\n          // 如果消息数量增加，并且用户在底部，自动滚动到底部\n          if (newMessages.length > this.lastMessageCount && this.autoScroll) {\n            this.scrollToBottom()\n          }\n          this.lastMessageCount = newMessages.length\n        })\n      },\n      immediate: true\n    },\n    friend: {\n      handler() {\n        // 切换好友时清空输入框并滚动到底部\n        this.messageContent = ''\n        this.$nextTick(() => {\n          this.scrollToBottom()\n          this.focusInput()\n        })\n      },\n      immediate: true\n    }\n  },\n  mounted() {\n    this.focusInput()\n    this.scrollToBottom()\n  },\n  methods: {\n    isOwnMessage(message) {\n      return message.fromUserID === this.currentUser?.userID\n    },\n\n    getMessageNickname(message) {\n      if (this.isOwnMessage(message)) {\n        return this.currentUser?.nickname || '我'\n      }\n      return this.friend?.nickname || `用户${message.fromUserID}`\n    },\n\n    getMessageAvatar(message) {\n      if (this.isOwnMessage(message)) {\n        return this.currentUser?.avatar\n      }\n      return this.friend?.avatar\n    },\n\n    formatMessageTime(timestamp) {\n      return formatMessageTime(timestamp)\n    },\n\n    handleKeyDown(event) {\n      if (event.ctrlKey && event.key === 'Enter') {\n        event.preventDefault()\n        this.sendMessage()\n      }\n    },\n\n    sendMessage() {\n      const content = this.messageContent.trim()\n      if (!content || this.sending) return\n\n      this.$emit('send-message', content)\n      this.messageContent = ''\n      \n      // 发送后滚动到底部\n      this.$nextTick(() => {\n        this.scrollToBottom()\n        this.focusInput()\n      })\n    },\n\n    focusInput() {\n      this.$refs.messageInput?.$refs?.textarea?.focus()\n    },\n\n    scrollToBottom() {\n      const messageList = this.$refs.messageList\n      if (messageList) {\n        scrollToBottom(messageList)\n      }\n    },\n\n    handleScroll() {\n      const messageList = this.$refs.messageList\n      if (!messageList) return\n\n      // 检查是否滚动到底部\n      this.autoScroll = isScrolledToBottom(messageList)\n\n      // 检查是否滚动到顶部，加载更多消息\n      if (messageList.scrollTop === 0 && this.messages.length > 0 && !this.loading) {\n        this.$emit('load-more')\n      }\n    },\n\n    showChatMenu() {\n      this.$message.info('聊天菜单功能开发中...')\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.chat-window {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: white;\n}\n\n.chat-header {\n  padding: 16px 20px;\n  border-bottom: 1px solid #e4e7ed;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background: white;\n  z-index: 10;\n}\n\n.friend-info {\n  display: flex;\n  align-items: center;\n}\n\n.avatar {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background: #409eff;\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 16px;\n  font-weight: 500;\n  margin-right: 12px;\n  flex-shrink: 0;\n\n  img {\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    object-fit: cover;\n  }\n}\n\n.friend-details {\n  .friend-name {\n    font-size: 16px;\n    font-weight: 500;\n    color: #303133;\n    margin-bottom: 4px;\n  }\n\n  .friend-status {\n    display: flex;\n    align-items: center;\n    font-size: 12px;\n    color: #909399;\n\n    .status-dot {\n      width: 6px;\n      height: 6px;\n      border-radius: 50%;\n      background: #c0c4cc;\n      margin-right: 4px;\n    }\n\n    &.online .status-dot {\n      background: #67c23a;\n    }\n  }\n}\n\n.message-list {\n  flex: 1;\n  overflow-y: auto;\n  padding: 20px;\n  background: #f8f9fa;\n  scroll-behavior: smooth;\n}\n\n.loading-more {\n  text-align: center;\n  padding: 16px;\n  color: #909399;\n  font-size: 14px;\n\n  i {\n    margin-right: 8px;\n  }\n}\n\n.message-item {\n  display: flex;\n  margin-bottom: 20px;\n  \n  &.own {\n    flex-direction: row-reverse;\n    \n    .message-content {\n      align-items: flex-end;\n      \n      .message-info {\n        text-align: right;\n      }\n      \n      .message-bubble {\n        background: #409eff;\n        color: white;\n        \n        &::before {\n          display: none;\n        }\n        \n        &::after {\n          content: '';\n          position: absolute;\n          top: 10px;\n          right: -8px;\n          width: 0;\n          height: 0;\n          border-left: 8px solid #409eff;\n          border-top: 6px solid transparent;\n          border-bottom: 6px solid transparent;\n        }\n      }\n    }\n    \n    .message-avatar {\n      margin-left: 12px;\n      margin-right: 0;\n    }\n  }\n}\n\n.message-avatar {\n  margin-right: 12px;\n  flex-shrink: 0;\n  \n  .avatar {\n    width: 36px;\n    height: 36px;\n    font-size: 14px;\n  }\n}\n\n.message-content {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  min-width: 0;\n}\n\n.message-info {\n  display: flex;\n  align-items: center;\n  margin-bottom: 6px;\n  \n  .sender-name {\n    font-size: 12px;\n    color: #606266;\n    font-weight: 500;\n    margin-right: 8px;\n  }\n  \n  .send-time {\n    font-size: 11px;\n    color: #c0c4cc;\n  }\n}\n\n.message-bubble {\n  position: relative;\n  max-width: 70%;\n  background: white;\n  border-radius: 16px;\n  padding: 10px 16px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: 10px;\n    left: -8px;\n    width: 0;\n    height: 0;\n    border-right: 8px solid white;\n    border-top: 6px solid transparent;\n    border-bottom: 6px solid transparent;\n  }\n  \n  .bubble-content {\n    word-wrap: break-word;\n    word-break: break-word;\n    line-height: 1.4;\n    font-size: 14px;\n  }\n}\n\n.empty-messages {\n  text-align: center;\n  color: #c0c4cc;\n  padding: 60px 20px;\n  \n  i {\n    font-size: 48px;\n    margin-bottom: 16px;\n    display: block;\n  }\n  \n  p {\n    font-size: 14px;\n    margin: 0;\n  }\n}\n\n.message-input {\n  border-top: 1px solid #e4e7ed;\n  background: white;\n}\n\n.input-toolbar {\n  padding: 12px 20px 8px;\n  border-bottom: 1px solid #f2f6fc;\n  \n  .el-button {\n    margin-right: 8px;\n    \n    &:last-child {\n      margin-right: 0;\n    }\n  }\n}\n\n.input-area {\n  padding: 0 20px 16px;\n  position: relative;\n  \n  .el-textarea {\n    :deep(.el-textarea__inner) {\n      border: none;\n      padding: 8px 0;\n      resize: none;\n      box-shadow: none;\n      background: transparent;\n      \n      &:focus {\n        border: none;\n        box-shadow: none;\n      }\n    }\n  }\n  \n  .input-actions {\n    text-align: right;\n    margin-top: 8px;\n  }\n}\n\n// 滚动条样式\n.message-list::-webkit-scrollbar {\n  width: 6px;\n}\n\n.message-list::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.message-list::-webkit-scrollbar-thumb {\n  background: #dcdfe6;\n  border-radius: 3px;\n}\n\n.message-list::-webkit-scrollbar-thumb:hover {\n  background: #c0c4cc;\n}\n\n// 响应式设计\n@media (max-width: 768px) {\n  .chat-header {\n    padding: 12px 16px;\n  }\n  \n  .message-list {\n    padding: 16px;\n  }\n  \n  .input-toolbar,\n  .input-area {\n    padding-left: 16px;\n    padding-right: 16px;\n  }\n  \n  .message-bubble {\n    max-width: 85%;\n  }\n}\n</style>","import mod from \"-!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ChatWindow.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ChatWindow.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ChatWindow.vue?vue&type=template&id=12eb6c50&scoped=true\"\nimport script from \"./ChatWindow.vue?vue&type=script&lang=js\"\nexport * from \"./ChatWindow.vue?vue&type=script&lang=js\"\nimport style0 from \"./ChatWindow.vue?vue&type=style&index=0&id=12eb6c50&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"12eb6c50\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"chat-room\">\n    <!-- 侧边栏 -->\n    <div class=\"sidebar\" :class=\"{ 'show': showSidebar }\">\n      <!-- 用户信息 -->\n      <div class=\"user-header\">\n        <div class=\"user-info\">\n          <div class=\"avatar\">\n            <img v-if=\"currentUser?.avatar\" :src=\"currentUser.avatar\" :alt=\"currentUser.nickname\" />\n            <span v-else>{{ currentUser?.nickname?.charAt(0) || 'U' }}</span>\n          </div>\n          <div class=\"user-details\">\n            <div class=\"nickname\">{{ currentUser?.nickname || '未知用户' }}</div>\n            <div class=\"status\" :class=\"connectionStatus\">\n              <i class=\"status-dot\"></i>\n              {{ statusText }}\n            </div>\n          </div>\n        </div>\n        <div class=\"user-actions\">\n          <el-dropdown @command=\"handleUserAction\">\n            <span class=\"el-dropdown-link\">\n              <i class=\"el-icon-more\"></i>\n            </span>\n            <el-dropdown-menu slot=\"dropdown\">\n              <el-dropdown-item command=\"addFriend\">添加好友</el-dropdown-item>\n              <el-dropdown-item command=\"settings\">设置</el-dropdown-item>\n              <el-dropdown-item command=\"logout\">退出登录</el-dropdown-item>\n            </el-dropdown-menu>\n          </el-dropdown>\n        </div>\n      </div>\n\n      <!-- 好友列表 -->\n      <FriendList \n        :friends=\"friendList\"\n        :selected-friend=\"selectedFriend\"\n        :loading=\"loadingFriends\"\n        @select-friend=\"handleSelectFriend\"\n        @add-friend=\"handleAddFriend\"\n      />\n    </div>\n\n    <!-- 主聊天区域 -->\n    <div class=\"main-content\">\n      <!-- 聊天窗口 -->\n      <ChatWindow \n        v-if=\"selectedFriend\"\n        :friend=\"selectedFriend\"\n        :messages=\"currentMessages\"\n        :loading=\"loadingHistory\"\n        :sending=\"sendingMessage\"\n        @send-message=\"handleSendMessage\"\n        @load-more=\"handleLoadMore\"\n      />\n      \n      <!-- 欢迎界面 -->\n      <div v-else class=\"welcome-screen\">\n        <div class=\"welcome-content\">\n          <i class=\"el-icon-chat-line-round welcome-icon\"></i>\n          <h3>欢迎使用 GoWebSocket IM</h3>\n          <p>选择一个好友开始聊天</p>\n          <el-button type=\"primary\" @click=\"handleAddFriend\">\n            <i class=\"el-icon-plus\"></i>\n            添加好友\n          </el-button>\n        </div>\n      </div>\n    </div>\n\n    <!-- 移动端侧边栏遮罩 -->\n    <div \n      v-if=\"showSidebar\" \n      class=\"sidebar-overlay\"\n      @click=\"showSidebar = false\"\n    ></div>\n\n    <!-- 添加好友对话框 -->\n    <el-dialog\n      title=\"添加好友\"\n      :visible.sync=\"addFriendDialog\"\n      width=\"400px\"\n      @close=\"resetAddFriendForm\"\n    >\n      <el-form ref=\"addFriendForm\" :model=\"addFriendForm\" :rules=\"addFriendRules\">\n        <el-form-item label=\"用户ID\" prop=\"friendID\">\n          <el-input\n            v-model=\"addFriendForm.friendID\"\n            placeholder=\"请输入要添加的用户ID\"\n            @keyup.enter.native=\"confirmAddFriend\"\n          />\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"addFriendDialog = false\">取 消</el-button>\n        <el-button type=\"primary\" :loading=\"addingFriend\" @click=\"confirmAddFriend\">\n          {{ addingFriend ? '添加中...' : '确 定' }}\n        </el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapGetters, mapActions } from 'vuex'\nimport FriendList from '@/components/friend/FriendList.vue'\nimport ChatWindow from '@/components/chat/ChatWindow.vue'\nimport { WS_URL, APP_CONFIG } from '@/utils/constants'\n\nexport default {\n  name: 'ChatRoom',\n  components: {\n    FriendList,\n    ChatWindow\n  },\n  data() {\n    return {\n      showSidebar: false,\n      addFriendDialog: false,\n      addingFriend: false,\n      addFriendForm: {\n        friendID: ''\n      },\n      addFriendRules: {\n        friendID: [\n          { required: true, message: '请输入用户ID', trigger: 'blur' },\n          { min: 3, max: 20, message: '用户ID长度在 3 到 20 个字符', trigger: 'blur' }\n        ]\n      }\n    }\n  },\n  computed: {\n    ...mapState('auth', ['userInfo']),\n    ...mapState('friend', ['friendList', 'selectedFriend', 'loadingFriends']),\n    ...mapState('chat', ['loadingHistory', 'sendingMessage']),\n    ...mapState('connection', ['status']),\n    ...mapGetters('auth', ['currentUser']),\n    ...mapGetters('chat', ['getCurrentMessages']),\n    ...mapGetters('connection', ['connectionStatus']),\n    \n    currentMessages() {\n      return this.getCurrentMessages\n    },\n    \n    statusText() {\n      switch (this.connectionStatus) {\n        case 'connected':\n          return '在线'\n        case 'connecting':\n          return '连接中...'\n        case 'reconnecting':\n          return '重连中...'\n        case 'disconnected':\n        default:\n          return '离线'\n      }\n    }\n  },\n  async mounted() {\n    await this.initializeApp()\n  },\n  beforeDestroy() {\n    // 断开WebSocket连接\n    this.disconnect()\n  },\n  methods: {\n    ...mapActions('auth', ['logout']),\n    ...mapActions('friend', ['fetchFriendList', 'addFriend', 'selectFriend']),\n    ...mapActions('chat', ['loadChatHistory', 'sendMessage', 'switchConversation']),\n    ...mapActions('connection', ['connect', 'disconnect']),\n\n    /**\n     * 初始化应用\n     */\n    async initializeApp() {\n      try {\n        // 1. 获取好友列表\n        await this.fetchFriendList()\n\n        // 2. 检查WebSocket连接状态，避免重复连接\n        const token = this.$store.state.auth.token\n        const currentStatus = this.connectionStatus\n        \n        console.log('ChatRoom初始化 - 当前连接状态:', currentStatus)\n        console.log('ChatRoom初始化 - 是否有token:', !!token)\n        \n        if (token && currentStatus !== 'connected' && currentStatus !== 'connecting') {\n          console.log('ChatRoom: 检测到未连接状态，尝试建立WebSocket连接')\n          await this.connect({\n            url: WS_URL,\n            token: token // 只传递token，不依赖userID\n          })\n        } else if (!token) {\n          console.warn('未找到token，无法建立WebSocket连接')\n          this.$message.warning('登录状态异常，请重新登录')\n        } else {\n          console.log('ChatRoom: WebSocket已连接或正在连接中，跳过连接步骤')\n        }\n      } catch (error) {\n        console.error('初始化应用失败:', error)\n        // 只有在非连接相关错误时才显示错误消息\n        if (error.message !== '正在连接中' && error.message !== 'WebSocket服务已销毁') {\n          this.$message.error('初始化失败，请刷新页面重试')\n        }\n      }\n    },\n\n    handleSelectFriend(friend) {\n      this.selectFriend(friend)\n      this.switchConversation(friend.userID)\n      \n      // 加载聊天记录\n      this.loadChatHistory({\n        friendID: friend.userID,\n        page: 1,\n        limit: APP_CONFIG.MESSAGE_PAGE_SIZE\n      })\n\n      // 移动端收起侧边栏\n      if (window.innerWidth <= 768) {\n        this.showSidebar = false\n      }\n    },\n\n    async handleSendMessage(content) {\n      if (!this.selectedFriend || !content.trim()) {\n        return\n      }\n\n      const result = await this.sendMessage({\n        friendID: this.selectedFriend.userID,\n        content: content.trim(),\n        messageType: 'text'\n      })\n\n      if (!result.success) {\n        this.$message.error(result.error || '发送消息失败')\n      }\n    },\n\n    async handleLoadMore() {\n      if (!this.selectedFriend) return\n\n      // 这里可以实现加载更多历史消息的逻辑\n      console.log('加载更多消息')\n    },\n\n    handleUserAction(command) {\n      switch (command) {\n        case 'addFriend':\n          this.handleAddFriend()\n          break\n        case 'settings':\n          this.$message.info('设置功能开发中...')\n          break\n        case 'logout':\n          this.handleLogout()\n          break\n      }\n    },\n\n    handleAddFriend() {\n      this.addFriendDialog = true\n    },\n\n    async confirmAddFriend() {\n      try {\n        await this.$refs.addFriendForm.validate()\n        \n        this.addingFriend = true\n        const result = await this.addFriend(this.addFriendForm.friendID.trim())\n        \n        if (result.success) {\n          this.$message.success('添加好友成功')\n          this.addFriendDialog = false\n          this.resetAddFriendForm()\n        } else {\n          this.$message.error(result.error || '添加好友失败')\n        }\n      } catch (error) {\n        console.error('添加好友失败:', error)\n      } finally {\n        this.addingFriend = false\n      }\n    },\n\n    resetAddFriendForm() {\n      this.addFriendForm.friendID = ''\n      this.$refs.addFriendForm?.resetFields()\n    },\n\n    async handleLogout() {\n      try {\n        await this.$confirm('确定要退出登录吗？', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        })\n\n        await this.logout()\n        this.$router.push('/login')\n      } catch (error) {\n        // 用户取消\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.chat-room {\n  height: 100vh;\n  display: flex;\n  background: #f5f7fa;\n}\n\n.sidebar {\n  width: 280px;\n  background: white;\n  border-right: 1px solid #e4e7ed;\n  display: flex;\n  flex-direction: column;\n  z-index: 100;\n  position: relative;\n}\n\n.user-header {\n  padding: 20px 16px;\n  border-bottom: 1px solid #f2f6fc;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.user-info {\n  display: flex;\n  align-items: center;\n  flex: 1;\n  min-width: 0;\n}\n\n.avatar {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background: #409eff;\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 16px;\n  font-weight: 500;\n  margin-right: 12px;\n  flex-shrink: 0;\n\n  img {\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    object-fit: cover;\n  }\n}\n\n.user-details {\n  flex: 1;\n  min-width: 0;\n}\n\n.nickname {\n  font-size: 16px;\n  font-weight: 500;\n  color: #303133;\n  margin-bottom: 4px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.status {\n  display: flex;\n  align-items: center;\n  font-size: 12px;\n  color: #909399;\n\n  .status-dot {\n    width: 6px;\n    height: 6px;\n    border-radius: 50%;\n    background: #909399;\n    margin-right: 4px;\n  }\n\n  &.connected .status-dot {\n    background: #67c23a;\n  }\n\n  &.connecting .status-dot,\n  &.reconnecting .status-dot {\n    background: #e6a23c;\n  }\n}\n\n.user-actions {\n  .el-dropdown-link {\n    cursor: pointer;\n    color: #606266;\n    font-size: 18px;\n    \n    &:hover {\n      color: #409eff;\n    }\n  }\n}\n\n.main-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  background: white;\n}\n\n.welcome-screen {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: #fafbfc;\n}\n\n.welcome-content {\n  text-align: center;\n  color: #909399;\n\n  .welcome-icon {\n    font-size: 64px;\n    margin-bottom: 20px;\n    color: #c0c4cc;\n  }\n\n  h3 {\n    font-size: 20px;\n    margin-bottom: 8px;\n    color: #606266;\n  }\n\n  p {\n    font-size: 14px;\n    margin-bottom: 24px;\n  }\n}\n\n.sidebar-overlay {\n  display: none;\n}\n\n// 响应式设计\n@media (max-width: 768px) {\n  .sidebar {\n    position: fixed;\n    top: 0;\n    left: 0;\n    height: 100vh;\n    transform: translateX(-100%);\n    transition: transform 0.3s ease;\n    z-index: 1000;\n\n    &.show {\n      transform: translateX(0);\n    }\n  }\n\n  .sidebar-overlay {\n    display: block;\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.3);\n    z-index: 999;\n  }\n\n  .main-content {\n    width: 100%;\n  }\n}\n</style>","import mod from \"-!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ChatRoom.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ChatRoom.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ChatRoom.vue?vue&type=template&id=50d1bc33&scoped=true\"\nimport script from \"./ChatRoom.vue?vue&type=script&lang=js\"\nexport * from \"./ChatRoom.vue?vue&type=script&lang=js\"\nimport style0 from \"./ChatRoom.vue?vue&type=style&index=0&id=50d1bc33&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"50d1bc33\",\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport VueRouter from 'vue-router'\nimport store from '@/store'\nimport LoginPage from '@/views/LoginPage.vue'\nimport ChatRoom from '@/views/ChatRoom.vue'\n\nVue.use(VueRouter)\n\nconst routes = [\n  {\n    path: '/',\n    redirect: '/chat'\n  },\n  {\n    path: '/login',\n    name: 'Login',\n    component: LoginPage,\n    meta: { \n      title: '登录',\n      requiresAuth: false \n    }\n  },\n  {\n    path: '/chat',\n    name: 'ChatRoom',\n    component: ChatRoom,\n    meta: { \n      title: '聊天室',\n      requiresAuth: true \n    }\n  }\n]\n\nconst router = new VueRouter({\n  mode: 'history',\n  base: process.env.BASE_URL,\n  routes\n})\n\n// 路由守卫\nrouter.beforeEach((to, from, next) => {\n  // 设置页面标题\n  if (to.meta.title) {\n    document.title = `${to.meta.title} - GoWebSocket IM`\n  }\n\n  // 检查是否需要认证\n  if (to.meta.requiresAuth) {\n    if (store.getters['auth/isLoggedIn']) {\n      next()\n    } else {\n      next({\n        name: 'Login',\n        query: { redirect: to.fullPath }\n      })\n    }\n  } else {\n    // 如果已登录且访问登录页，重定向到聊天室\n    if (to.name === 'Login' && store.getters['auth/isLoggedIn']) {\n      next({ name: 'ChatRoom' })\n    } else {\n      next()\n    }\n  }\n})\n\nexport default router","import Vue from 'vue'\r\nimport App from './App.vue'\r\nimport router from './router'\r\nimport store from './store'\r\nimport ElementUI from 'element-ui'\r\nimport 'element-ui/lib/theme-chalk/index.css'\r\nimport './styles/global.scss'\r\nimport webSocketService from '@/services/websocket'\r\nimport { WS_URL } from '@/utils/constants'\r\n\r\nVue.use(ElementUI)\r\n\r\nVue.config.productionTip = false\r\n\r\n/**\r\n * 初始化应用并检查自动登录\r\n * 只负责验证token有效性，不进行WebSocket连接\r\n */\r\nasync function initApp() {\r\n  // 检查本地是否有token缓存\r\n  const token = localStorage.getItem('gowebsocket_token')\r\n  \r\n  if (token) {\r\n    try {\r\n      console.log('检测到本地token，设置到store中')\r\n      \r\n      // 设置store中的token状态\r\n      store.commit('auth/SET_TOKEN', token)\r\n      \r\n      console.log('token已设置到store，WebSocket连接将由具体页面组件负责')\r\n      \r\n    } catch (error) {\r\n      console.error('初始化token失败:', error)\r\n      // 如果token处理失败，清理无效的token\r\n      console.log('清理无效的token缓存')\r\n      localStorage.removeItem('gowebsocket_token')\r\n      localStorage.removeItem('userInfo')\r\n      store.dispatch('auth/logout')\r\n    }\r\n  } else {\r\n    console.log('未检测到本地token，需要用户手动登录')\r\n  }\r\n}\r\n\r\nnew Vue({\r\n  router,\r\n  store,\r\n  render: h => h(App),\r\n  async created() {\r\n    // 应用创建时只初始化登录状态，不连接WebSocket\r\n    await initApp()\r\n  }\r\n}).$mount('#app')","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdO = {};","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkgowebsocket_frontend\"] = self[\"webpackChunkgowebsocket_frontend\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], () => (__webpack_require__(486)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["render","_vm","this","_c","_self","attrs","staticRenderFns","name","component","TOKEN_KEY","setToken","token","localStorage","setItem","getToken","getItem","removeToken","removeItem","api","axios","create","baseURL","timeout","interceptors","request","use","config","headers","Authorization","error","Promise","reject","response","status","window","location","href","authAPI","login","data","post","logout","getCurrentUser","get","friendAPI","getFriendList","addFriend","friendID","deleteFriend","delete","messageAPI","getChatHistory","params","sendMessage","markAsRead","put","getUnreadCount","auth","namespaced","state","isAuthenticated","loginLoading","userInfo","JSON","parse","mutations","SET_TOKEN","SET_LOGIN_LOADING","loading","SET_USER_INFO","stringify","CLEAR_AUTH","actions","commit","userID","appID","code","user","success","isNewUser","message","console","root","getters","isLoggedIn","currentUser","profile","SET_APP_ID","SET_PROFILE","CLEAR_USER_INFO","fetchProfile","log","currentUserID","currentNickname","nickname","currentAvatar","avatar","friend","friendList","onlineUsers","selectedFriend","loadingFriends","SET_FRIEND_LIST","friends","SET_ONLINE_USERS","users","SET_SELECTED_FRIEND","SET_LOADING_FRIENDS","ADD_FRIEND","find","f","push","REMOVE_FRIEND","filter","UPDATE_FRIEND_STATUS","isOnline","UPDATE_FRIEND_UNREAD","unreadCount","CLEAR_FRIENDS","fetchFriendList","selectFriend","updateFriendOnlineStatus","updateFriendUnreadCount","onlineFriends","offlineFriends","totalUnreadCount","reduce","total","getFriendByID","chat","conversations","currentConversation","loadingHistory","sendingMessage","SET_CONVERSATION","messages","ADD_MESSAGE","exists","m","messageID","PREPEND_MESSAGES","SET_CURRENT_CONVERSATION","SET_LOADING_HISTORY","SET_SENDING_MESSAGE","sending","CLEAR_CONVERSATIONS","CLEAR_CONVERSATION","loadChatHistory","page","limit","hasMore","dispatch","content","messageType","receiveMessage","fromUserID","switchConversation","getCurrentMessages","getMessagesByFriend","hasMessages","length","WS_URL","APP_CONFIG","APP_ID","DEFAULT_AVATAR","MESSAGE_PAGE_SIZE","HEARTBEAT_INTERVAL","RECONNECT_MAX_ATTEMPTS","RECONNECT_DELAY","WS_COMMANDS","LOGIN","LOGOUT","HEARTBEAT","MESSAGE","ENTER","EXIT","PING","CONNECTION_STATUS","DISCONNECTED","CONNECTING","CONNECTED","RECONNECTING","generateId","Date","now","Math","random","toString","substr","formatTime","time","date","diff","floor","toDateString","toLocaleTimeString","hour","minute","yesterday","setDate","getDate","toLocaleDateString","formatMessageTime","month","day","debounce","func","wait","args","later","clearTimeout","setTimeout","scrollToBottom","element","smooth","scrollTo","top","scrollHeight","behavior","isScrolledToBottom","threshold","scrollTop","clientHeight","generateUserId","generateAppId","timestamp","WebSocketService","constructor","ws","heartbeatTimer","reconnectTimer","maxReconnectAttempts","reconnectAttempts","reconnectDelay","heartbeatInterval","isConnecting","isDestroyed","url","messageQueue","onOpen","bind","onMessage","onClose","onError","connect","resolve","Error","readyState","WebSocket","OPEN","store","onopen","onmessage","onclose","onerror","disconnect","stopHeartbeat","stopReconnect","close","send","warn","sendLogin","substring","loginMessage","seq","cmd","serviceToken","sendHeartbeat","heartbeatData","hasToken","savedToken","storeToken","startHeartbeat","processMessageQueue","event","handleMessage","reason","attemptReconnect","handleChatMessage","handleUserEnter","handleUserExit","handleHeartbeat","handleLoginResponse","from","to","msg","messageObj","toUserID","toISOString","isRead","AUTHENTICATED","setInterval","clearInterval","delay","then","catch","shift","isConnected","getConnectionStatus","CLOSING","CLOSED","webSocketService","connection","lastHeartbeat","SET_CONNECTION_STATUS","SET_WEBSOCKET","SET_RECONNECT_ATTEMPTS","attempts","INCREMENT_RECONNECT_ATTEMPTS","RESET_RECONNECT_ATTEMPTS","SET_HEARTBEAT_INTERVAL","interval","SET_LAST_HEARTBEAT","CLEAR_CONNECTION","isReconnecting","connectionStatus","modules","strict","staticClass","_m","ref","loginForm","loginRules","nativeOn","$event","preventDefault","handleLogin","apply","arguments","type","indexOf","_k","keyCode","key","model","value","callback","$$v","$set","expression","slot","on","regenerateAppId","_v","trim","_s","_l","id","quickLogin","required","trigger","min","max","quickLoginIds","computed","mounted","$store","$router","methods","$refs","validate","result","$message","wsError","redirect","$route","query","class","showSidebar","charAt","statusText","handleUserAction","handleSelectFriend","handleAddFriend","currentMessages","handleSendMessage","handleLoadMore","_e","addFriendDialog","resetAddFriendForm","addFriendForm","addFriendRules","confirmAddFriend","addingFriend","handleSearch","searchKeyword","showOnline","directives","rawName","$emit","showOffline","formatLastSeen","lastSeen","filteredFriends","props","Array","default","Object","Boolean","filteredOnlineFriends","filterFriends","filteredOfflineFriends","watch","handler","updateFilteredFriends","immediate","created","debouncedSearch","keyword","toLowerCase","includes","showChatMenu","handleScroll","isOwnMessage","getMessageAvatar","getMessageNickname","handleKeyDown","messageContent","autoScroll","lastMessageCount","newMessages","$nextTick","focusInput","ctrlKey","messageInput","textarea","focus","messageList","info","components","FriendList","ChatWindow","initializeApp","beforeDestroy","currentStatus","warning","innerWidth","command","handleLogout","resetFields","$confirm","confirmButtonText","cancelButtonText","routes","path","LoginPage","meta","title","requiresAuth","ChatRoom","router","mode","base","beforeEach","next","document","fullPath","async","initApp","productionTip","h","App","$mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","loaded","__webpack_modules__","amdO","deferred","O","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","keys","every","splice","r","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","g","globalThis","Function","e","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","nmd","paths","children","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","forEach","__webpack_exports__"],"sourceRoot":""}